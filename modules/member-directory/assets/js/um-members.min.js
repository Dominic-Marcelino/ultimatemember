var um_members_directory_busy=[],um_member_directories=[],um_member_directory_last_data=[];function um_parse_current_url(){var r={},t=window.location.search.substring(1).split("&");return jQuery.each(t,function(e){e=t[e].split("=");r[e[0]]=e[1]}),r}function um_get_data_for_directory(e,r){var t=um_members_get_hash(e),a={},i=um_parse_current_url();if(jQuery.each(i,function(e){-1!==e.indexOf("_"+t)&&""!==i[e]&&(a[e.replace("_"+t,"")]=i[e])}),r){if(void 0!==a[r])try{a[r]=decodeURIComponent(a[r])}catch(e){console.error(e)}return a[r]}return a}function um_set_url_from_data(e,r,t){var a=um_members_get_hash(e),i=um_get_data_for_directory(e),m={},s=(Array.isArray(t)?(jQuery.each(t,function(e){t[e]=encodeURIComponent(t[e])}),t=t.join("||")):jQuery.isNumeric(t)||(t=t.split("||"),jQuery.each(t,function(e){t[e]=encodeURIComponent(t[e])}),t=t.join("||")),""!==t&&(m[r+"_"+a]=t),jQuery.each(i,function(e){r===e?""!==t&&(m[e+"_"+a]=t):m[e+"_"+a]=i[e]}),jQuery.each(um_member_directories,function(e){var r,t=um_member_directories[e];t!==a&&(r=um_get_data_for_directory(jQuery('.um-directory[data-hash="'+t+'"]')),jQuery.each(r,function(e){m[e+"_"+t]=r[e]}))}),[]),e=(jQuery.each(m,function(e){s.push(e+"="+m[e])}),"?"+(s=wp.hooks.applyFilters("um_member_directory_url_attrs",s)).join("&"));"?"===e&&(e=""),window.history.pushState("string","UM Member Directory",window.location.origin+window.location.pathname+e)}function um_members_get_hash(e){return e.data("hash")}function um_is_directory_busy(e){e=um_members_get_hash(e);return void 0!==um_members_directory_busy[e]&&um_members_directory_busy[e]}function um_members_show_preloader(e){um_members_directory_busy[um_members_get_hash(e)]=!0,e.find(".um-members-overlay").show()}function um_members_hide_preloader(e){um_members_directory_busy[um_members_get_hash(e)]=!1,e.find(".um-members-overlay").hide()}function um_set_range_label(e,r){var t,a="",i=e.siblings(".um-slider-range").data("placeholder-s"),m=e.siblings(".um-slider-range").data("placeholder-p"),r=r?(a=(r.values[0]===r.values[1]?i.replace("{value}",r.values[0]):m.replace("{min_range}",r.values[0]).replace("{max_range}",r.values[1])).replace("{field_label}",e.siblings(".um-slider-range").data("label")),t=r.values[0],r.values[1]):(a=(e.slider("values",0)===e.slider("values",1)?i.replace("{value}",e.slider("values",0)):m.replace("{min_range}",e.slider("values",0)).replace("{max_range}",e.slider("values",1))).replace("{field_label}",e.siblings(".um-slider-range").data("label")),t=e.slider("values",0),e.slider("values",1));e.siblings(".um-slider-range").html(a),e.siblings(".um_range_min").val(t),e.siblings(".um_range_max").val(r)}function um_get_search(e){return e.find(".um-search-line").length?e.find(".um-search-line").val():""}function um_get_sort(e){return e.data("sorting")}function um_get_current_page(e){e=e.data("page");return e=e&&void 0!==e?e:1}function um_time_convert(e,r){var t=Math.floor(e/60),e=e%60;return(t=60<=e&&(e=0,24<=(t+=1))?0:t)+":"+(e=e<10?"0"+e:e)}function um_ajax_get_members(m,e){var r,t,a,i,s,d=um_members_get_hash(m);wp.hooks.applyFilters("um_member_directory_get_members_allow",!0,d,m)?(r=um_get_current_page(m),t=um_get_search(m),a=um_get_sort(m),i=-(new Date).getTimezoneOffset()/60,s={directory_id:d,page:r,search:t,sorting:a,gmt_offset:i,post_refferer:m.data("base-post"),nonce:um_scripts.nonce},m.find(".um-search-filter").length&&m.find(".um-search-filter").each(function(){var e,r,t,a,i=jQuery(this);i.find(".um-slider").length?(t=i.find(".um-slider").data("field_name"),e=um_get_data_for_directory(m,"filter_"+t+"_from"),r=um_get_data_for_directory(m,"filter_"+t+"_to"),void 0===e&&void 0===r||(s[t]=[e,r])):i.find("select").length?(t=i.find("select").attr("name"),void 0!==(a=um_get_data_for_directory(m,"filter_"+t))&&(a=um_unsanitize_value(a),s[t]=a.split("||"))):i.hasClass("um-text-filter-type")&&i.find('input[type="text"]').length?(t=i.find('input[type="text"]').attr("name"),void 0!==(a=um_get_data_for_directory(m,"filter_"+t))&&(a=um_unsanitize_value(a),s[t]=a)):s=wp.hooks.applyFilters("um_member_directory_custom_filter_handler",s,i,m)}),s=wp.hooks.applyFilters("um_member_directory_filter_request",s),wp.ajax.send("um_get_members",{data:s,success:function(e){um_member_directory_last_data[d]=e,um_build_template(m,e);var r=wp.template("um-members-pagination");m.find(".um-members-pagination-box").html(r(e)),m.data("total_pages",e.pagination.total_pages),e.pagination.total_pages?(m.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"),m.find(".um-member-directory-sorting").removeClass("disabled")):(m.find(".um-member-directory-users-counter").addClass("um-header-row-invisible"),m.find(".um-member-directory-sorting").addClass("disabled")),wp.hooks.doAction("um_member_directory_loaded",m,e),um_init_new_dropdown(),um_members_hide_preloader(m)},error:function(e){console.log(e),um_members_hide_preloader(m)}})):setTimeout(um_ajax_get_members,600,m,e)}function init_more_details_modal(){jQuery(".um-member-more-details-link").umModal({header:wp.i18n.__("More details","ultimate-member"),content:function(e,r){let t=this;var r=r.relatedButton,a=um_members_get_hash(r.parents(".um-directory"));wp.ajax.send("um_member_directory_get_more_details",{data:{user_id:r.data("user_id"),directory_id:a,nonce:um_scripts.nonce},beforeSend:function(){t.addClass("loading")},success:function(e){t.removeClass("loading"),t.find(".um-modal-body").html(e),UM.modal.responsive(t)},error:function(e){t.removeClass("loading"),console.error(e)}})}})}function um_build_template(e,r){var t=e.data("view_type"),t=wp.template("um-member-"+t+"-"+um_members_get_hash(e)),t=((r.pagination.total_pages?e.find(".um-members-wrapper").removeClass("um-members-empty"):e.find(".um-members-wrapper").addClass("um-members-empty")).html("").prepend(t(r.users)),wp.template("um-members-header"));e.find(".um-member-directory-total-users").html(t(r)).parents(".um-member-directory-header-row").removeClass("um-header-row-invisible"),e.addClass("um-loaded"),jQuery(document).trigger("um_build_template",[e,r]),jQuery(window).trigger("resize"),init_tipsy(),init_more_details_modal()}function um_get_filters_data(u){var o=[];return u.find(".um-search-filter").each(function(){var t,a,i,m,e,r,s,d=jQuery(this);d.find("select").length?(t="select",a=d.find("select").attr("name"),i=d.find("select").data("placeholder"),m=void 0===(m=um_get_data_for_directory(u,"filter_"+a))?[]:(m=um_unsanitize_value(m)).split("||"),jQuery.each(m,function(e){var r=d.find('select option[value="'+m[e]+'"]').data("value_label");o.push({name:a,label:i,value_label:r,value:m[e],type:t})})):d.hasClass("um-text-filter-type")&&d.find('input[type="text"]').length?(t="text",a=d.find('input[type="text"]').attr("name"),i=d.find('input[type="text"]').attr("placeholder"),""!=(m=void 0===(m=um_get_data_for_directory(u,"filter_"+a))?"":m)&&o.push({name:a,label:i,value_label:m,value:m,type:t})):d.find("div.ui-slider").length?(t="slider",a=d.find("div.ui-slider").data("field_name"),e=um_get_data_for_directory(u,"filter_"+a+"_from"),r=um_get_data_for_directory(u,"filter_"+a+"_to"),void 0===e&&void 0===r||(s=(e===r?d.find("div.um-slider-range").data("placeholder-s").replace("{value}",e):d.find("div.um-slider-range").data("placeholder-p").replace("{min_range}",e).replace("{max_range}",r)).replace("{field_label}",d.find("div.um-slider-range").data("label")),i=d.find("div.um-slider-range").data("label"),o.push({name:a,label:i,value_label:s,value:[e,r],type:t}))):o=wp.hooks.applyFilters("um_member_directory_get_filter_data",o,u,d)}),o}function um_change_tag(e){var r,t=um_get_filters_data(e),a=(e.find(".um-members-filter-tag").remove(),e.find(".um-filtered-line"));a.length&&(r=wp.template("um-members-filtered-line"),a.prepend(r({filters:t})),0===e.find(".um-members-filter-remove").length?(e.find(".um-clear-filters").hide(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(e.find(".um-clear-filters").show(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible")))}function um_run_search(e){if(!um_is_directory_busy(e)){um_members_show_preloader(e);var r=um_get_data_for_directory(e,"search"),t=um_sanitize_value(e.find(".um-search-line").val());if(t===r||""===t&&void 0===r)um_members_hide_preloader(e);else{e.data("general_search",t),um_set_url_from_data(e,"search",t),e.data("page",1),um_set_url_from_data(e,"page","");if(!wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e)){r=e.data("must-search");if(1===r&&(t=um_get_search(e),0===e.find(".um-members-filter-remove").length)&&!t)return e.data("searched",0),e.find(".um-members-wrapper").html(""),e.find(".um-members-total").remove(),e.find(".um-member-directory-sorting").addClass("disabled"),e.find(".um-member-directory-users-counter").addClass("um-header-row-invisible"),wp.hooks.doAction("um_member_directory_clear_not_searched",e),void um_members_hide_preloader(e)}e.data("searched",1),e.find(".um-member-directory-sorting").removeClass("disabled"),e.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"),um_ajax_get_members(e)}}}jQuery(document.body).ready(function(){jQuery(".um-directory .um-search-filter select").each(function(){1===jQuery(this).find("option:not(:disabled)").length&&jQuery(this).prop("disabled",!0);var e=jQuery(this);e.select2("destroy").select2({dropdownParent:e.parent(),containerCssClass:"um-select2-selection",dropdownCssClass:"um-select2-dropdown"})}),jQuery(document.body).on("click",".um-directory .um-do-search",function(){um_run_search(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("keypress",".um-directory .um-search-line",function(e){13===e.which&&um_run_search(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("click",'.um-new-dropdown[data-element=".um-member-directory-sorting-a"] li a',function(){var e,r,t;1===jQuery(this).data("selected")||(e=jQuery(this).data("directory-hash"),um_is_directory_busy(e=jQuery('.um-directory[data-hash="'+e+'"]')))||(um_members_show_preloader(e),r=jQuery(this).html(),t=jQuery(this).data("value"),e.data("sorting",t),um_set_url_from_data(e,"sort",t),um_ajax_get_members(e),e.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]').find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),e.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"] a[data-value="'+t+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),e.find(".um-member-directory-sorting-a").find("> a").html(r))}),jQuery(document.body).on("click",".um-directory .pagi:not(.current)",function(){var e,r;jQuery(this).hasClass("disabled")||um_is_directory_busy(e=jQuery(this).parents(".um-directory"))||(um_members_show_preloader(e),(1===(r="first"===jQuery(this).data("page")?1:"prev"===jQuery(this).data("page")?+e.data("page")-1:"next"===jQuery(this).data("page")?+e.data("page")+1:"last"===jQuery(this).data("page")?parseInt(e.data("total_pages")):parseInt(jQuery(this).data("page")))?(e.find('.pagi[data-page="first"], .pagi[data-page="prev"]').addClass("disabled"),e.find('.pagi[data-page="prev"], .pagi[data-page="last"]')):(r===parseInt(e.data("total_pages"))?e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').addClass("disabled"):e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled"),e.find('.pagi[data-page="first"], .pagi[data-page="prev"]'))).removeClass("disabled"),e.find(".pagi").removeClass("current"),e.find('.pagi[data-page="'+r+'"]').addClass("current"),e.data("page",r),um_set_url_from_data(e,"page",1===r?"":r),um_ajax_get_members(e))}),jQuery(document.body).on("change",".um-directory .um-members-pagi-dropdown",function(){var e,r=jQuery(this).parents(".um-directory");um_is_directory_busy(r)||(um_members_show_preloader(r),e=jQuery(this).val(),r.find(".pagi").removeClass("current"),r.find('.pagi[data-page="'+e+'"]').addClass("current"),r.data("page",e),um_set_url_from_data(r,"page",1===e?"":e),um_ajax_get_members(r))}),jQuery(".um-filters-toggle").on("click",function(){var e=jQuery(this),r=e.parents(".um-directory").find(".um-search");r.is(":visible")?r.slideUp(250,function(){e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}):r.slideDown({duration:250,start:function(){jQuery(this).css({display:"grid"}),e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}})}),jQuery(document.body).on("change",".um-directory .um-search-filter select",function(){var e,r,t,a=jQuery(this).val(),i=um_sanitize_value(a);""===i||um_is_directory_busy(e=jQuery(this).parents(".um-directory"))||(um_members_show_preloader(e),t=void 0===(t=um_get_data_for_directory(e,"filter_"+(r=jQuery(this).prop("name"))))?[]:t.split("||"),-1===jQuery.inArray(i,t)&&(t.push(i),um_set_url_from_data(e,"filter_"+r,t=t.join("||")),e.data("page",1),um_set_url_from_data(e,"page","")),jQuery(this).find('option[value="'+a+'"]').prop("disabled",!0).hide(),1===jQuery(this).find("option:not(:disabled)").length&&jQuery(this).prop("disabled",!0),(i=jQuery(this)).select2("destroy").select2({dropdownParent:i.parent(),containerCssClass:"um-select2-selection",dropdownCssClass:"um-select2-dropdown"}),i.val("").trigger("change"),um_ajax_get_members(e),um_change_tag(e),e.data("searched",1),e.find(".um-member-directory-sorting").removeClass("disabled"),e.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"))}),jQuery(document.body).on("blur",'.um-directory .um-search-filter.um-text-filter-type input[type="text"]',function(){var e,r,t,a=jQuery(this).parents(".um-directory");um_is_directory_busy(a)||(e=um_sanitize_value(jQuery(this).val()))!==(t=void 0===(t=um_get_data_for_directory(a,"filter_"+(r=jQuery(this).prop("name"))))?"":t)&&(um_members_show_preloader(a),um_set_url_from_data(a,"filter_"+r,e),a.data("page",1),um_set_url_from_data(a,"page",""),um_ajax_get_members(a),um_change_tag(a),a.data("searched",1),a.find(".um-member-directory-sorting").removeClass("disabled"),a.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"))}),jQuery(document.body).on("keypress",'.um-directory .um-search-filter.um-text-filter-type input[type="text"]',function(e){var r,t,a;13!==e.which||um_is_directory_busy(e=jQuery(this).parents(".um-directory"))||(r=um_sanitize_value(jQuery(this).val()))!==(a=void 0===(a=um_get_data_for_directory(e,"filter_"+(t=jQuery(this).prop("name"))))?"":a)&&(um_members_show_preloader(e),um_set_url_from_data(e,"filter_"+t,r),e.data("page",1),um_set_url_from_data(e,"page",""),um_ajax_get_members(e),um_change_tag(e),e.data("searched",1),e.find(".um-member-directory-sorting").removeClass("disabled"),e.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"))}),jQuery(document.body).on("click",".um-directory .um-members-filter-remove",function(){var e=jQuery(this).parents(".um-directory");if(!um_is_directory_busy(e)&&e){um_members_show_preloader(e);var r=jQuery(this).data("value"),t=jQuery(this).data("name"),a=jQuery(this).data("type"),i=("text"===a?(um_set_url_from_data(e,"filter_"+t,""),jQuery('.um-search-filter input[name="'+t+'"]').val("")):"select"===a?(m=void 0===(m=um_get_data_for_directory(e,"filter_"+t))?[]:(m=um_unsanitize_value(m)).split("||"),um_set_url_from_data(e,"filter_"+t,m=(m=-1!==jQuery.inArray(r.toString(),m)?jQuery.grep(m,function(e){return e!==r.toString()}):m).length?m:""),(m=jQuery('.um-search-filter select[name="'+t+'"]')).find('option[value="'+r+'"]').prop("disabled",!1).show(),1<m.find("option:not(:disabled)").length&&m.prop("disabled",!1),m.select2("destroy").select2({dropdownParent:m.parent(),containerCssClass:"um-select2-selection",dropdownCssClass:"um-select2-dropdown"}),0<e.find('.um-search-filter select[data-um-parent="'+t+'"]').length&&m.trigger("change")):"slider"===a?(um_set_url_from_data(e,"filter_"+t+"_from",""),um_set_url_from_data(e,"filter_"+t+"_to",""),i=(m=jQuery(".um-search-filter #"+t+"_min").siblings(".um-slider")).slider("option"),m.slider("values",[i.min,i.max]),jQuery(".um-search-filter #"+t+"_min").val(""),jQuery(".um-search-filter #"+t+"_max").val(""),um_set_range_label(m)):"datepicker"===a||"timepicker"===a?(um_set_url_from_data(e,"filter_"+t+"_from",""),um_set_url_from_data(e,"filter_"+t+"_to",""),jQuery(".um-search-filter #"+t+"_from").val(""),jQuery(".um-search-filter #"+t+"_to").val("")):wp.hooks.doAction("um_member_directory_filter_remove",a,e,t,r),e.data("page",1),um_set_url_from_data(e,"page",""),jQuery(this).tipsy("hide"),jQuery(this).parents(".um-members-filter-tag").remove(),0===e.find(".um-members-filter-remove").length?e.find(".um-clear-filters").hide():e.find(".um-clear-filters").show(),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!i)if(1===e.data("must-search")){var m=um_get_search(e);if(0===e.find(".um-members-filter-remove").length&&!m)return e.data("searched",0),e.find(".um-members-wrapper").html(""),e.find(".um-members-total").remove(),e.find(".um-member-directory-sorting").addClass("disabled"),e.find(".um-member-directory-users-counter").addClass("um-header-row-invisible"),wp.hooks.doAction("um_member_directory_clear_not_searched",e),void um_members_hide_preloader(e)}e.find(".um-member-directory-sorting").removeClass("disabled"),e.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"),um_ajax_get_members(e)}}),jQuery(document.body).on("click",".um-directory .um-clear-filters-a",function(){var m=jQuery(this).parents(".um-directory");if(!um_is_directory_busy(m)){um_members_show_preloader(m),m.find(".um-members-filter-remove").each(function(){var e,r,t=jQuery(this).data("value"),a=jQuery(this).data("name"),i=jQuery(this).data("type");"text"===i?(um_set_url_from_data(m,"filter_"+a,""),jQuery('.um-search-filter input[name="'+a+'"]').val("")):"select"===i?(e=void 0===(e=um_get_data_for_directory(m,"filter_"+a))?[]:(e=um_unsanitize_value(e)).split("||"),(e=-1!==jQuery.inArray(t.toString(),e)?jQuery.grep(e,function(e){return e!==t.toString()}):e).length||(e=""),um_set_url_from_data(m,"filter_"+a,e),(e=jQuery('.um-search-filter select[name="'+a+'"]')).find('option[value="'+t+'"]').prop("disabled",!1).show(),1<e.find("option:not(:disabled)").length&&e.prop("disabled",!1),e.select2("destroy").select2({dropdownParent:e.parent(),containerCssClass:"um-select2-selection",dropdownCssClass:"um-select2-dropdown"}),0<m.find('.um-search-filter select[data-um-parent="'+a+'"]').length&&e.trigger("change")):"slider"===i?(um_set_url_from_data(m,"filter_"+a+"_from",""),um_set_url_from_data(m,"filter_"+a+"_to",""),r=(e=jQuery(".um-search-filter #"+a+"_min").siblings(".um-slider")).slider("option"),e.slider("values",[r.min,r.max]),jQuery(".um-search-filter #"+a+"_min").val(""),jQuery(".um-search-filter #"+a+"_max").val(""),um_set_range_label(e)):"datepicker"===i||"timepicker"===i?(um_set_url_from_data(m,"filter_"+a+"_from",""),um_set_url_from_data(m,"filter_"+a+"_to",""),jQuery(".um-search-filter #"+a+"_from").val(""),jQuery(".um-search-filter #"+a+"_to").val("")):wp.hooks.doAction("um_member_directory_clear_filters",i,m,a,t)}),m.data("page",1),um_set_url_from_data(m,"page",""),m.find(".um-members-filter-tag").remove(),0===m.find(".um-members-filter-remove").length?(m.find(".um-clear-filters").hide(),m.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(m.find(".um-clear-filters").show(),m.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible"));if(!wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,m)){var e=m.data("must-search");if(1===e)if(!um_get_search(m))return m.data("searched",0),m.find(".um-members-wrapper").html(""),m.find(".um-members-total").remove(),m.find(".um-member-directory-sorting").addClass("disabled"),m.find(".um-member-directory-users-counter").addClass("um-header-row-invisible"),wp.hooks.doAction("um_member_directory_clear_not_searched",m),void um_members_hide_preloader(m)}um_ajax_get_members(m)}}),wp.hooks.doAction("um_member_directory_on_first_pages_loading"),jQuery(".um-directory").each(function(){var e=jQuery(this),r=um_members_get_hash(e),t=(um_member_directories.push(r),e.find(".um-search").length&&!e.find(".um-search").is(":visible")&&e.find(".um-search").css({display:"grid"}).slideUp(1),e.find(".um-slider").each(function(){var e=jQuery(this),t=e.parents(".um-directory"),a=e.data("field_name"),r=um_get_data_for_directory(t,"filter_"+a+"_from"),i=um_get_data_for_directory(t,"filter_"+a+"_to"),r=[r=void 0===r?parseInt(e.data("min")):r,i=void 0===i?parseInt(e.data("max")):i];e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:r,create:function(e,r){},step:1,slide:function(e,r){um_set_range_label(jQuery(this),r)},stop:function(e,r){um_is_directory_busy(t)||(um_members_show_preloader(t),um_set_url_from_data(t,"filter_"+a+"_from",r.values[0]),um_set_url_from_data(t,"filter_"+a+"_to",r.values[1]),t.data("page",1),um_set_url_from_data(t,"page",""),um_ajax_get_members(t),um_change_tag(t),t.data("searched",1),t.find(".um-member-directory-sorting").removeClass("disabled"),t.find(".um-member-directory-users-counter").removeClass("um-header-row-invisible"))}}),um_set_range_label(e)}),wp.hooks.doAction("um_member_directory_on_init",e,r),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!t&&1===e.data("must-search")){t=um_get_search(e);if(!um_get_filters_data(e).length&&!t)return}wp.hooks.applyFilters("um_member_directory_prevent_default_first_loading",!1,e,r)||(um_members_show_preloader(e),um_ajax_get_members(e,{first_load:!0}),um_change_tag(e))}),window.addEventListener("popstate",function(e){jQuery(".um-directory").each(function(){var a=jQuery(this),e=um_members_get_hash(a),r=(um_member_directories.push(e),um_members_show_preloader(a),a.find(".um-members-wrapper").html(""),a.find(".um-members-total").remove(),a.find(".um-member-directory-search-line").length&&(i=um_get_data_for_directory(a,"search"),a.data("general_search",i=void 0===i?"":i),a.find(".um-search-line").val(i)),um_get_data_for_directory(a,"page")),t=(void 0===r?r=1:r>a.data("total_pages")&&(r=a.data("total_pages")),a.data("page",r).attr("data-page",r),a.find(".um-member-directory-sorting").length&&(void 0===(r=um_get_data_for_directory(a,"sort"))&&(r=a.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]').find('a[data-default="1"]').data("value")),a.data("sorting",r),(t=a.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]')).find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),t.find('a[data-value="'+r+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),a.find(".um-member-directory-sorting-a").find("> a").html(t.find('a[data-value="'+r+'"]').html())),a.find(".um-slider").each(function(){var e=jQuery(this),r=e.data("field_name"),t=um_get_data_for_directory(a,"filter_"+r+"_from"),r=um_get_data_for_directory(a,"filter_"+r+"_to");void 0===t&&(t=e.data("min")),t=parseInt(t),void 0===r&&(r=e.data("max")),r=parseInt(r),e.slider("values",[t,r]),um_set_range_label(e)}),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,a));if(!t&&1===a.data("must-search")){var i=um_get_search(a);if(!um_get_filters_data(a).length&&!i)return a.data("searched",0),void um_members_hide_preloader(a);a.data("searched",1)}wp.hooks.applyFilters("um_member_directory_prevent_default_first_loading",!1,a,e)||(um_ajax_get_members(a),um_change_tag(a))})})});