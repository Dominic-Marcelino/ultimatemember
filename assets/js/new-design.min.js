"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.profile&&(UM.profile={}),UM.profile={avatarModal:null,avatarCropper:null,avatarUploaderObj:null,avatarUploaderObjs:[],avatarUploaderInit:function(){jQuery(".um-profile-photo-uploader-overflow").each(function(){let r=jQuery(this),n=r.data("user_id");var e=r.data("nonce");let i=r.data("apply_nonce"),l=r.data("decline_nonce");e={browse_button:r.get(0),url:wp.ajax.settings.url+"?action=um_upload_profile_photo&user_id="+n+"&nonce="+e,chunk_size:"1024kb",max_retries:1,multipart:!0,multi_selection:!1,filters:{max_file_size:"10mb",mime_types:[{title:wp.i18n.__("Image files","ultimate-member"),extensions:"jpg,jpeg,gif,png,bmp,ico,tiff"}],prevent_duplicates:!0,max_file_count:1},init:{Error:function(e,o){},FileFiltered:function(e,o){},FilesAdded:function(e,o){r.parents(".um-profile-photo-uploader").addClass("um-processing"),e.start()},FilesRemoved:function(e,o){},FileUploaded:function(e,o,a){var t;200===a.status&&a.response?(t=JSON.parse(a.response))&&(t.info&&0===t.OK?console.error(t.info):t.data&&(t={classes:"um-profile-photo-modal",duration:400,footer:"",header:wp.i18n.__("Change your profile photo","ultimate-member"),size:"normal",content:'<div class="um-profile-photo-crop-wrapper" data-crop="square" data-ratio="1" data-min_width="256" data-min_height="256"><img src="'+t.data[0].url+'" class="um-profile-photo-crop fusion-lazyload-ignore" alt="" /></div><div class="um-modal-buttons-wrapper"><button type="button" class="um-button um-button-primary um-button-size-m um-apply-avatar-crop" data-user_id="'+n+'" data-nonce="'+i+'">'+wp.i18n.__("Apply","ultimate-member")+'</button><button type="button" class="um-button um-button-size-m um-modal-avatar-decline" data-user_id="'+n+'" data-nonce="'+l+'">'+wp.i18n.__("Cancel","ultimate-member")+'</button><span class="um-ajax-spinner-svg um-ajax-spinner-s"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none"><path d="M45 24C45 26.7578 44.4568 29.4885 43.4015 32.0364C42.3461 34.5842 40.7993 36.8992 38.8492 38.8492C36.8992 40.7993 34.5842 42.3461 32.0364 43.4015C29.4885 44.4568 26.7578 45 24 45C21.2422 45 18.5115 44.4568 15.9636 43.4015C13.4158 42.3461 11.1008 40.7993 9.15075 38.8492C7.20072 36.8992 5.65388 34.5842 4.59853 32.0363C3.54318 29.4885 3 26.7578 3 24C3 21.2422 3.54318 18.5115 4.59853 15.9636C5.65388 13.4158 7.20073 11.1008 9.15076 9.15075C11.1008 7.20072 13.4158 5.65387 15.9637 4.59853C18.5115 3.54318 21.2423 3 24 3C26.7578 3 29.4885 3.54318 32.0364 4.59853C34.5842 5.65388 36.8992 7.20073 38.8493 9.15077C40.7993 11.1008 42.3461 13.4158 43.4015 15.9637C44.4568 18.5115 45 21.2423 45 24L45 24Z" stroke="var(--um-gray-100,#f2f4f7)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 3C26.7578 3 29.4885 3.54318 32.0364 4.59853C34.5842 5.65388 36.8992 7.20073 38.8492 9.15076C40.7993 11.1008 42.3461 13.4158 43.4015 15.9637C44.4568 18.5115 45 21.2422 45 24" stroke="var(--um-primary-600-bg,#7f56d9)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/></svg></span></div>',source:r},UM.profile.avatarModal=UM.modal.addModal(t,null))):console.error(wp.i18n.__("File was not loaded, Status Code %s","ultimate-member"),[a.status])},PostInit:function(e){},UploadProgress:function(e,o){},UploadComplete:function(o,a){jQuery.each(a,function(e){o.removeFile(a[e].id)}),r.parents(".um-profile-photo-uploader").removeClass("um-processing")}}},e=wp.hooks.applyFilters("um_avatar_uploader_filters_attrs",e,r);UM.profile.avatarUploaderObj=new plupload.Uploader(e),UM.profile.avatarUploaderObjs[UM.profile.avatarUploaderObj.id]=UM.profile.avatarUploaderObj,UM.profile.avatarUploaderObj.init()})}},jQuery(document).ready(function(n){UM.profile.avatarUploaderInit(),n(document.body).on("click",".um-modal-avatar-decline",function(e){e.preventDefault();e=n(this);let o=e.siblings(".um-ajax-spinner-svg"),a=e.parents(".um-modal-buttons-wrapper").find(".um-button");var t=e.data("user_id"),e=e.data("nonce");a.prop("disabled",!0),o.show(),wp.ajax.send("um_decline_profile_photo_change",{data:{user_id:t,nonce:e},success:function(){o.hide(),UM.frontend.cropper.obj&&UM.frontend.cropper.destroy(),UM.modal.close()},error:function(e){a.prop("disabled",!1),o.hide(),console.log(e)}})}),n(document.body).on("click",".um-apply-avatar-crop",function(o){o.preventDefault();o=n(this);if(0<o.parents(".um-modal-body").find(".cropper-hidden").length&&UM.frontend.cropper.obj){let e=o.siblings(".um-ajax-spinner-svg");var t=o.parents(".um-modal-buttons-wrapper").find(".um-button");let a=o.data("user_id");var o=o.data("nonce"),r=UM.frontend.cropper.obj.getData(),r=Math.round(r.x)+","+Math.round(r.y)+","+Math.round(r.width)+","+Math.round(r.height);r&&(t.prop("disabled",!0),e.show(),wp.ajax.send("um_apply_profile_photo_change",{data:{coord:r,user_id:a,nonce:o},success:function(o){n('[data-um-modal-opened="1"]').siblings(".um-avatar").find("> img").replaceWith(o.avatar),o.all_sizes&&n.each(o.all_sizes,function(e){n(".um-avatar-"+e+'[data-user_id="'+a+'"]').find("> img").replaceWith(o.all_sizes[e])}),e.hide(),UM.frontend.cropper.obj&&UM.frontend.cropper.destroy(),UM.modal.close()},error:function(e){console.log(e)}}))}})}),wp.hooks.addAction("um-modal-shown","ultimate-member",function(e){e.find(".um-profile-photo-crop-wrapper").length&&UM.frontend.cropper.init()},10,1),wp.hooks.addAction("um-modal-before-close","ultimate-member",function(e){e.find(".um-modal-avatar-decline:not(:disabled)").length&&e.find(".um-modal-avatar-decline").trigger("click"),UM.frontend.cropper.obj&&UM.frontend.cropper.destroy()});