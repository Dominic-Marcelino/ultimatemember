var um_radioStates={};function um_recalculate_indexes(e){e.find(".um-admin-option-row").each(function(e){jQuery(this).show().attr("data-option_index",e).data("option_index",e);var i=jQuery(this).find(".um-admin-option-default-multi").data("base-name"),i=(jQuery(this).find(".um-admin-option-default-multi").attr("name",i+"["+e+"]"),jQuery(this).find(".um-admin-option-default").attr("value",e),jQuery(this).find(".um-admin-option-key").data("base-name")),i=(jQuery(this).find(".um-admin-option-key").attr("name",i+"["+e+"]"),jQuery(this).find(".um-admin-option-val").data("base-name"));jQuery(this).find(".um-admin-option-val").attr("name",i+"["+e+"]")}),um_radio_set_states(e)}function um_multi_or_not(e,i){var i=i.find(".um-admin-option-rows"),t=i.find(".um-admin-option-row");e.is(":checked")?(t.find(".um-admin-option-default-multi").prop("disabled",!1).show(),t.find(".um-admin-option-default").prop("disabled",!0).prop("checked",!1).hide()):(t.find(".um-admin-option-default-multi").prop("disabled",!0).prop("checked",!1).hide(),t.find(".um-admin-option-default").prop("disabled",!1).show()),um_radio_set_states(i)}function um_admin_init_draggable(t){t.sortable({items:".um-admin-option-row",forcePlaceholderSize:!0,update:function(e,i){um_recalculate_indexes(t)}}),um_radio_set_states(t)}function um_radio_set_states(e){um_radioStates={},jQuery.each(e.find(".um-admin-option-default"),function(e,i){um_radioStates[i.value]=jQuery(i).is(":checked")})}function um_maybe_init_tinymce(e){e.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor").length&&um_tinymce_init(e.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor-content").data("editor_id"),e.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor-content").html())}function um_tinymce_init(i,e){tinyMCEPreInit.mceInit[i]=tinyMCEPreInit.mceInit.um_editor_placeholder,tinyMCEPreInit.qtInit[i]=tinyMCEPreInit.qtInit.um_editor_placeholder,tinyMCEPreInit.mceInit[i]=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[i]).replaceAll(/um_editor_placeholder/gm,i)),tinyMCEPreInit.qtInit[i]=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[i]).replaceAll(/um_editor_placeholder/gm,i));var t=jQuery("<div>").append(jQuery("#wp-um_editor_placeholder-wrap").clone()),n=jQuery('.um-admin-editor-content[data-editor_id="'+i+'"]'),t=(t.find("#um_editor_placeholder").attr("name",n.data("editor_name")),t[0].innerHTML.replaceAll(new RegExp("um_editor_placeholder","gm"),i));n.siblings(".um-admin-editor").replaceWith(t),"object"==typeof tinyMCE&&null!==tinyMCE.get("um_editor_placeholder")?(n.siblings(".wp-editor-wrap").find(".wp-editor-container > .mce-tinymce.mce-container.mce-panel").remove(),"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),tinyMCE.init(tinyMCEPreInit.mceInit[i]),tinyMCE.get(i).setContent(e),jQuery("#"+i).html(e),"object"==typeof window.switchEditors&&window.switchEditors.go(i)):("function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),jQuery("#"+i).html(e)),jQuery(document.body).on("click",".wp-switch-editor",function(){var e=jQuery(this);e.hasClass("wp-switch-editor")&&"object"==typeof window.switchEditors&&(e=e.hasClass("switch-tmce")?"tmce":"html",window.switchEditors.go(i,e))}),n.remove()}"undefined"==typeof um_admin_field_groups_data&&(um_admin_field_groups_data={}),"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.fields_groups&&(UM.fields_groups={}),UM.fields_groups={tabs:{setActive:function(e,i){var t=e.data("tab"),e=(e.parents(".um-field-row-tabs").find("div[data-tab]").removeClass("current"),e.addClass("current"),e.parents(".um-field-row-tabs").siblings(".um-field-row-tabs-content"));e.find("div[data-tab]").removeClass("current"),e.find('div[data-tab="'+t+'"]').addClass("current")},compare:function(e,i){if(e.length!==i.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==i[t])return!1;return!0},compareDeep:function(e,n){if(typeof e!=typeof n)return!1;if("object"!=typeof e)return e===n;{if(!UM.fields_groups.tabs.compare(Object.keys(e),Object.keys(n)))return!1;let t=!0;return Object.entries(e).forEach(([e,i])=>{if(!(t=UM.fields_groups.tabs.compareDeep(i,n[e])))return!1}),t}},reBuild:function(e,i,t){var n=e.children(".um-field-row-content").children(".um-field-row-tabs"),d=e.children(".um-field-row-content").children(".um-field-row-tabs-content"),e=n.children("div[data-tab].current").data("tab");n.children("div[data-tab]").remove(),d.children("div[data-tab]").each(function(){i.includes(t(this).data("tab"))||t(this).remove()});let o="";for(var l=0;l<i.length;l++)o+='<div data-tab="'+i[l]+'">'+um_admin_field_groups_data.field_tabs[i[l]]+"</div>",d.children('div[data-tab="'+i[l]+'"]').length||d.append('<div data-tab="'+i[l]+'"></div>');n.html(o),n.children('div[data-tab="'+e+'"]').addClass("current"),d.children('div[data-tab="'+e+'"]').addClass("current")}},sortable:{init:function(e,i){e.sortable({items:".um-field-row",connectWith:"um-fields-column-content",placeholder:"um-field-row-placeholder",forcePlaceholderSize:!0,axis:"y",cursor:"move",handle:".um-field-row-move-link",update:function(){UM.fields_groups.sortable.update(i(this),i)}}).on("sortupdate",function(){UM.fields_groups.sortable.update(i(this),i)})},update:function(e,i){e.children(".um-field-row").each(function(e){e=+e+1;i(this).children(".um-field-row-order").val(e),i(this).children(".um-field-row-header").children(".um-field-row-move-link").text(e)}),UM.fields_groups.field.conditional.prepareFieldsList(i),UM.fields_groups.field.conditional.showHideConditionalTabs(i),UM.fields_groups.field.conditional.fillRulesFields(i)},destroy:function(e){e.hasClass("ui-sortable")&&e.sortable("destroy")},reInit:function(e,i){UM.fields_groups.sortable.destroy(e),UM.fields_groups.sortable.init(e,i),e.trigger("sortupdate")}},field:{newIndex:0,settingsScreens:{},prepareSettings:function(d,e,o){d(".um-fields-column-content > .um-field-row").each(function(){let t=d(this).data("field"),n=d(this).children(".um-field-row-content").children(".um-field-row-tabs-content").children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").val();void 0!==e&&e!=t||("object"!=typeof UM.fields_groups.field.settingsScreens[t]&&(UM.fields_groups.field.settingsScreens[t]={}),"object"!=typeof UM.fields_groups.field.settingsScreens[t][n]&&(UM.fields_groups.field.settingsScreens[t][n]={}),d(this).children(".um-field-row-content").children(".um-field-row-tabs").children("div[data-tab]").each(function(){var e,i=d(this).data("tab");void 0!==o&&o!=i||((e=d(this).closest(".um-field-row-tabs").siblings(".um-field-row-tabs-content").children('div[data-tab="'+i+'"]').children(".um-form-table").clone()).find(".wp-editor-wrap").replaceWith('<div class="um-admin-editor"></div><div class="um-admin-editor-content" data-editor_id="'+e.find("textarea.wp-editor-area").attr("id")+'" data-editor_name="'+e.find("textarea.wp-editor-area").attr("name")+'">'+e.find("textarea.wp-editor-area").val()+"</div>"),UM.fields_groups.field.settingsScreens[t][n][i]=e[0].outerHTML)}))})},sanitizeInput:function(e){return e.replace(/<(|\/|[^>\/bi]|\/[^>bi]|[^\/>][^>]+|\/[^>][^>]+)>/g,"")},checkIfMultiple:function(e){e.find(".um-field-row-multiple-input").length&&e.find(".um-field-row-multiple-input").trigger("change")},add:function(e,o){var i=e.closest(".um-fields-column").children(".um-fields-column-content");let t=e.closest(".um-field-row").data("field");void 0===t&&(t=0);e=o(".um-field-row-template").clone().addClass("um-field-row").removeClass("um-field-row-template");UM.fields_groups.field.newIndex++;let l=UM.fields_groups.field.newIndex;e.data("field","new_"+l).attr("data-field","new_"+l);var n=i.find("> .um-field-row").length+1,d=(e.find(".um-field-row-move-link").text(n),e.find(".um-field-row-id")),a=(d.removeAttr("disabled").prop("disabled",!1),d.attr("name")),d=(void 0!==a&&(a=a.replace("{index}",l),d.attr("name",a)),e.find(".um-field-row-parent-id")),a=(d.removeAttr("disabled").prop("disabled",!1),d.attr("name")),d=(void 0!==a&&(a=a.replace("{index}",l),d.attr("name",a).val(t)),e.find(".um-field-row-order")),a=(d.val(n).removeAttr("disabled").prop("disabled",!1),d.attr("name"));void 0!==a&&(n=a.replace("{index}",l),d.attr("name",n)),e.find(".um-form-table").each(function(e){let i=o(this).data("extra-class");void 0!==i&&(i=i.replace("{index}",l))&&o(this).removeAttr("class").removeAttr("data-extra-class").addClass("form-table um-form-table "+i)}),e.find(".um-forms-line").each(function(e){var i=o(this).data("prefix"),i=(void 0!==i&&(i=i.replace("new_index","new_"+l),o(this).data("prefix",i).attr("data-prefix",i)),o(this).find("label")),t=i.attr("for"),i=(void 0!==t&&(t=t.replace("new_index","new_"+l),i.attr("for",t)),o(this).find(".um-forms-field")),t=(o(this).find(".um-conditional-rule-setting").each(function(e){var i=o(this).data("base-name"),i=(void 0!==i&&(i=i.replace("{index}",l),o(this).data("base-name",i).attr("data-base-name",i)),o(this).attr("name"));void 0!==i&&(i=i.replace("{index}",l),o(this).attr("name",i))}),i.attr("id")),n=(void 0!==t&&(n=t.replace("new_index","new_"+l),i.attr("id",n)),i.attr("name"));void 0!==n&&(n=n.replace("{index}",l),i.attr("name",n)),i.removeAttr("disabled").prop("disabled",!1);let d=[i.siblings('input[type="hidden"]'),o(this).find("#"+t+"_hidden")];o.each(d,function(e){var i,e=d[e];e.length&&(void 0!==(i=e.attr("id"))&&(i=i.replace("new_index","new_"+l),e.attr("id",i)),void 0!==(i=e.attr("name"))&&(i=i.replace("{index}",l),e.attr("name",i)),e.removeAttr("disabled").prop("disabled",!1))})}),i.append(e),1<i.children(".um-field-row").length?UM.fields_groups.sortable.reInit(i,o):(i.removeClass("hidden"),i.siblings(".um-fields-column-header").removeClass("hidden"),i.siblings(".um-fields-column-empty-content").addClass("hidden"),UM.fields_groups.sortable.init(i,o)),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(o),UM.fields_groups.field.conditional.showHideConditionalTabs(o),UM.fields_groups.field.conditional.fillRulesFields(o)},toggleEdit:function(e,i){e.hasClass("um-field-row-edit-mode")?UM.fields_groups.field.hideEdit(e,i):UM.fields_groups.field.showEdit(e,i)},showEdit:function(e,i){e.addClass("um-field-row-edit-mode"),UM.fields_groups.field.checkIfMultiple(e)},hideEdit:function(e,i){e.removeClass("um-field-row-edit-mode")},duplicate:function(e,i){var t=e.closest(".um-fields-column-content"),n=e.closest(".um-field-row").clone();e.closest(".um-field-row").after(n),UM.fields_groups.sortable.reInit(t,i),UM.fields_groups.field.conditional.prepareFieldsList(i)},delete:function(e,i){var t=e.closest(".um-fields-column-content"),e=e.closest(".um-field-row");delete UM.fields_groups.field.settingsScreens[e.data("field")],e.remove(),t.find(".um-field-row").length?UM.fields_groups.sortable.reInit(t,i):(t.addClass("hidden"),t.siblings(".um-fields-column-header").addClass("hidden"),t.siblings(".um-fields-column-empty-content").removeClass("hidden"),UM.fields_groups.sortable.destroy(t)),UM.fields_groups.field.conditional.prepareFieldsList(i),UM.fields_groups.field.conditional.showHideConditionalTabs(i),UM.fields_groups.field.conditional.fillRulesFields(i)},conditional:{fieldsList:{},prepareFieldsList:function(r){r(".um-fields-column-content").each(function(){let a=r(this).data("uniqid");UM.fields_groups.field.conditional.fieldsList[a]={},r(this).children(".um-field-row").each(function(){var e=r(this).children(".um-field-row-content").find('> .um-field-row-tabs-content > div[data-tab="general"] > .um-form-table > tbody > .um-forms-line:not([data-field_type="sub_fields"])'),n=e.find(".um-field-row-type-select").val();if(um_admin_field_groups_data.field_types[n].conditional_rules.length){var d=r(this).data("field"),o=UM.fields_groups.field.sanitizeInput(e.find(".um-field-row-title-input").val()),l=r(this).children(".um-field-row-order").val();let i={},t=(um_admin_field_groups_data.field_types[n].conditional_rules.forEach(e=>{i[e]=um_admin_field_groups_data.conditional_rules[e]}),null);"choice"===um_admin_field_groups_data.field_types[n].category&&(t=[],"bool"===n?t=[{key:0,value:wp.i18n.__("False","ultimate-member")},{key:1,value:wp.i18n.__("True","ultimate-member")}]:e.each(function(){"choices"===r(this).data("field_type")&&r(this).find(".um-admin-option-row").each(function(){var e=r(this).find(".um-admin-option-key").val(),i=r(this).find(".um-admin-option-val").val();t.push({key:e,value:i})})})),UM.fields_groups.field.conditional.fieldsList[a][l]={id:d,type:n,title:o,conditions:i,valueOptions:t,order:l}}})})},showHideConditionalTabs:function(t){t(".um-fields-column-content").each(function(){t(this).children(".um-field-row:first").each(function(){t(this).data("conditional-disabled",!0);var e=t(this).children(".um-field-row-content"),i=e.children(".um-field-row-tabs").children('div[data-tab="conditional"]'),i=(i.hasClass("current")&&i.siblings('div[data-tab="general"]').trigger("click"),i.hide(),e.children(".um-field-row-content").children('div[data-tab="conditional"]'));i.find(".um-forms-field").prop("disabled",!0),i.find(".um-conditional-rule-condition-col .um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0),i.find(".um-conditional-rule-value-col input.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0),i.find(".um-conditional-rule-value-col select.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0)}),t(this).children(".um-field-row:not(:first)").each(function(){t(this).data("conditional-disabled",!1);var e=t(this).children(".um-field-row-content"),e=(e.children(".um-field-row-tabs").children('div[data-tab="conditional"]').show(),e.children(".um-field-row-content").children('div[data-tab="conditional"]'));e.find(".um-forms-field").prop("disabled",!1),e.find(".um-conditional-rule-condition-col .um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1),e.find(".um-conditional-rule-value-col input.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1),e.find(".um-conditional-rule-value-col select.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1)})}),run_check_conditions()},fillRulesFields:function(a){a(".um-fields-column-content").each(function(){let l=a(this).data("uniqid");a(this).children(".um-field-row").each(function(){if(!0!==a(this).data("conditional-disabled")&&void 0!==UM.fields_groups.field.conditional.fieldsList[l]){let n=a(this).children(".um-field-row-order").val();a(this).children(".um-field-row-content").children(".um-field-row-tabs-content").children('div[data-tab="conditional"]').find(".um-conditional-rule-field-col .um-conditional-rule-setting").each(function(){let t=a(this),o=t.val();t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l],function(e,i){e>=n||(t.find('option[value="'+i.id+'"]').length||t.append('<option value="'+i.id+'">'+i.title+"</option>"),String(i.id)===String(o)&&t.val(o).trigger("change"))});var e=a(this).closest(".um-conditional-rule-fields");if(""===o)e.find(".um-conditional-rule-condition-col .um-conditional-rule-setting").prop("disabled",!0),e.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),e.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{var i=a('.um-field-row[data-field="'+o+'"]').children(".um-field-row-order").val();let t=e.find(".um-conditional-rule-condition-col .um-conditional-rule-setting"),n=t.val(),d=(t.prop("disabled",!1),t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l][i].conditions,function(e,i){t.find('option[value="'+e+'"]').length||t.append('<option value="'+e+'">'+i+"</option>"),String(e)===String(n)&&t.val(n)}),null);if(null===UM.fields_groups.field.conditional.fieldsList[l][i].valueOptions)d=e.find(".um-conditional-rule-value-col input.um-conditional-rule-setting"),""!==n&&"!=empty"!==n&&"==empty"!==n?d.prop("disabled",!1):d.prop("disabled",!0),d.show(),e.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{let t=(d=e.find(".um-conditional-rule-value-col select.um-conditional-rule-setting")).val();e.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),""!==n&&"!=empty"!==n&&"==empty"!==n?d.prop("disabled",!1):d.prop("disabled",!0),d.show(),d.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l][i].valueOptions,function(e,i){d.find('option[value="'+i.key+'"]').length||d.append('<option value="'+i.key+'">'+i.value+"</option>"),String(i.key)===String(t)&&d.val(t)})}}})}})})},reset:function(e,i){e.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-conditional-rules-wrapper .um-conditional-remove-rule").each(function(e){i(this).trigger("click")})},addRulesGroup:function(e,t){var i=e.siblings(".um-conditional-rules-group-template").clone().addClass("um-conditional-rules-group").removeClass("um-conditional-rules-group-template");let n=e.find(".um-conditional-rules-group").length;i.data("group-index",n).attr("data-group-index",n),i.find(".um-conditional-rule-setting").each(function(e){var i=t(this).attr("name");void 0!==i&&(i=i.replace("{group_key}",n),t(this).attr("name",i),t(this).parents(".um-conditional-rule-field-col").length)&&t(this).prop("disabled",!1).removeAttr("disabled")}),e.find(".um-conditional-rules-wrapper-bottom").before(i),UM.fields_groups.field.conditional.showReset(e,t)},addRule:function(e,t){var i=e.parents(".um-conditional-rules-wrapper"),n=i.siblings(".um-conditional-rule-row-template").clone().addClass("um-conditional-rule-row").removeClass("um-conditional-rule-row-template");let d=e.parents(".um-conditional-rules-group").data("group-index"),o=e.parents(".um-conditional-rules-group").find(".um-conditional-rule-row").length;n.find(".um-conditional-rule-setting").each(function(e){var i=t(this).attr("name");if(void 0!==i){let e=i.replace("{group_key}",d);e=e.replace("{row_key}",o),t(this).attr("name",e),t(this).parents(".um-conditional-rule-field-col").length&&t(this).prop("disabled",!1).removeAttr("disabled")}}),e.after(n),UM.fields_groups.field.conditional.changeInputIndex(i,t),UM.fields_groups.field.conditional.showReset(i,t)},removeRule:function(e,i){var t=e.parents(".um-conditional-rules-wrapper"),n=t.find(".um-conditional-rule-row");1===n.length?(n.find(".um-conditional-rule-field-col select").val(""),n.find(".um-conditional-rule-condition-col select").val(""),n.find(".um-conditional-rule-value-col select,.um-conditional-rule-value-col input").val(""),UM.fields_groups.field.conditional.hideReset(t,i)):((1===(n=e.parents(".um-conditional-rules-group")).find(".um-conditional-rule-row").length?n:e).remove(),UM.fields_groups.field.conditional.changeInputIndex(t,i))},changeInputIndex:function(e,n){let d=0;e.find(".um-conditional-rules-group").each(function(e){let t=0;n(this).find(".um-conditional-rule-row").each(function(e){n(this).find(".um-conditional-rule-setting").each(function(e){var i=n(this).data("base-name");if(void 0!==i){let e=i.replace("{group_key}",d);e=e.replace("{row_key}",t),n(this).attr("name",e)}}),t++}),n(this).data("group-index",d).attr("data-group-index",d),d++})},showReset:function(e,i){e.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-field-row-reset-all-conditions").css({visibility:"visible"})},hideReset:function(e,i){e.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-field-row-reset-all-conditions").css({visibility:"hidden"})},parseRules:function(e,i){let t=[];return e.find(".um-conditional-rule-field-col select,.um-conditional-rule-condition-col select,.um-conditional-rule-value-col select,.um-conditional-rule-value-col input").each(function(e){""!==i(this).val()&&t.push(i(this))}),t},isEmpty:function(e,i){return!UM.fields_groups.field.conditional.parseRules(e,i).length}},changeType:function(i,d){let n=i.data("field");var e=i.data("previousValue"),t=um_admin_field_groups_data.field_types[e].settings;let o=i.children(".um-field-row-content").children(".um-field-row-tabs"),l=i.children(".um-field-row-content").children(".um-field-row-tabs-content");var a=l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select");let r=a.val();var s=um_admin_field_groups_data.field_types[r].settings,u=Object.keys(t),c=Object.keys(s),a=a.find('option[value="'+r+'"]').html();if(i.find("> .um-field-row-header > .um-field-row-type").text(UM.fields_groups.field.sanitizeInput(a)),"object"==typeof UM.fields_groups.field.settingsScreens[n]&&"object"==typeof UM.fields_groups.field.settingsScreens[n][e]&&d.each(UM.fields_groups.field.settingsScreens[n][e],function(e,i){var e=l.children('div[data-tab="'+e+'"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find("textarea.wp-editor-area");e.length&&(e=e.attr("id"),"object"==typeof tinyMCE)&&null!==tinyMCE.get(e)&&(tinyMCE.triggerSave(),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,e),"4"===tinyMCE.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,e):window.tinyMCE.execCommand("mceRemoveControl",!0,e))}),UM.fields_groups.tabs.compare(u,c)||UM.fields_groups.tabs.reBuild(i,c,d),o.children("div[data-tab]").addClass("disabled"),"object"==typeof UM.fields_groups.field.settingsScreens[n]&&"object"==typeof UM.fields_groups.field.settingsScreens[n][r])d.each(UM.fields_groups.field.settingsScreens[n][r],function(e,i){var t=l.children('div[data-tab="'+e+'"]');let n=d("<div>").append(i).find(".form-table");"conditional"===e&&n.find('[data-field_type="conditional_rules"]').html(t.find('[data-field_type="conditional_rules"]').html()),t.find(".um-field-row-static-setting").each(function(){let e=d(this).val();n.find('[name="'+d(this).attr("name")+'"]').each(function(){"hidden"!==d(this).attr("type")&&"checkbox"!==d(this).attr("type")&&d(this).val(e)})}),t.html(n[0].outerHTML),um_maybe_init_tinymce(t)}),l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").removeClass("disabled").prop("disabled",!1),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(d),o.children("div[data-tab]").removeClass("disabled"),UM.fields_groups.field.checkIfMultiple(i);else{if(!UM.fields_groups.tabs.compareDeep(t.general,s.general)){l.children('div[data-tab="general"]').find("> .form-table > tbody > .um-forms-line .um-forms-field:not(.um-field-row-static-setting)").closest(".um-forms-line").remove();var m=Object.keys(s.general).length-2;if(0<m){let e=0;for(;e<m;)l.children('div[data-tab="general"]').children(".form-table").children("tbody").append('<tr class="um-forms-line um-forms-skeleton"><th><span class="um-skeleton-box" style="width:100%;height:20px;"></span></th><td><span class="um-skeleton-box" style="width:100%;height:40px;margin-bottom:4px;"></span><span class="um-skeleton-box" style="width:100%;height:14px;"></span></td></tr>'),e++}}wp.ajax.send("um_fields_groups_get_settings_form",{data:{field_id:n,type:r,nonce:um_admin_scripts.nonce},success:function(e){"object"!=typeof UM.fields_groups.field.settingsScreens[n]&&(UM.fields_groups.field.settingsScreens[n]={}),"object"!=typeof UM.fields_groups.field.settingsScreens[n][r]&&(UM.fields_groups.field.settingsScreens[n][r]={}),d.each(e.fields,function(e,i){UM.fields_groups.field.settingsScreens[n][r][e]=i;let t=d("<div>").append(i).find(".form-table");i=l.children('div[data-tab="'+e+'"]');"conditional"===e&&t.find('[data-field_type="conditional_rules"]').html(i.find('[data-field_type="conditional_rules"]').html()),i.find(".um-field-row-static-setting").each(function(){let e=d(this).val();t.find('[name="'+d(this).attr("name")+'"]').each(function(){"hidden"!==d(this).attr("type")&&"checkbox"!==d(this).attr("type")&&d(this).val(e)})}),i.html(t[0].outerHTML),um_maybe_init_tinymce(i)}),l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").removeClass("disabled").prop("disabled",!1),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(d),o.children("div[data-tab]").removeClass("disabled"),UM.fields_groups.field.checkIfMultiple(i)},error:function(e){console.error(e)}})}}}},jQuery(function(a){a(".um-field-row > .um-field-row-id").each(function(){""===a(this).val()&&UM.fields_groups.field.newIndex++});a(".um-fields-column-content").each(function(){UM.fields_groups.sortable.init(a(this),a)}),UM.fields_groups.field.conditional.prepareFieldsList(a),UM.fields_groups.field.conditional.showHideConditionalTabs(a),UM.fields_groups.field.conditional.fillRulesFields(a),console.log("-------- Conditional -----------"),console.log(UM.fields_groups.field.conditional.fieldsList),console.log("-------------"),UM.fields_groups.field.prepareSettings(a),console.log(UM.fields_groups.field.settingsScreens),a(document.body).on("click",".um-field-row",function(e){var i;void 0!==e.target&&e.target.classList.contains("um-field-row-toggle-edit")&&(e.preventDefault(),i=a(this),UM.fields_groups.field.toggleEdit(i,a),e.stopPropagation())}),a(document.body).on("click",".um-field-row-action-edit",function(e){e.preventDefault();e=a(this).closest(".um-field-row");UM.fields_groups.field.toggleEdit(e,a)}),a(document.body).on("click",".um-field-row-action-delete",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure you want to delete this field?","ultimate-member"))&&UM.fields_groups.field.delete(a(this),a)}),a(document.body).on("click",".um-field-row-action-duplicate",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure you want to duplicate this field?","ultimate-member"))&&UM.fields_groups.field.duplicate(a(this),a)}),a(document.body).on("click",".um-add-field-to-column",function(e){e.preventDefault(),UM.fields_groups.field.add(a(this),a)}),a(document.body).on("click",".um-field-row-tabs > div[data-tab]:not(.current)",function(e){e.preventDefault(),a(this).hasClass("disabled")||UM.fields_groups.tabs.setActive(a(this),a)}),a(document.body).on("click",".um-field-row-reset-all-conditions",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure?","ultimate-member"))&&UM.fields_groups.field.conditional.reset(a(this),a)}),a(document.body).on("click",".um-conditional-add-rules-group",function(e){e.preventDefault();e=a(this).parents(".um-conditional-rules-wrapper");UM.fields_groups.field.conditional.addRulesGroup(e,a)}),a(document.body).on("click",".um-conditional-add-rule",function(e){e.preventDefault();e=a(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.addRule(e,a)}),a(document.body).on("click",".um-conditional-remove-rule",function(e){e.preventDefault();e=a(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.removeRule(e,a)}),a(document.body).on("change",".um-conditional-rule-field-col select, .um-conditional-rule-condition-col select, .um-conditional-rule-value-col select,.um-conditional-rule-value-col input",function(e){var i=a(this).parents('.um-field-row-tabs-content > div[data-tab="conditional"]');UM.fields_groups.field.conditional.isEmpty(i,a)?UM.fields_groups.field.conditional.hideReset(a(this),a):UM.fields_groups.field.conditional.showReset(a(this),a)}),a(document.body).on("change",".um-conditional-rule-field-col .um-conditional-rule-setting",function(e){var i=a(this).closest(".um-fields-column-content").data("uniqid");if(void 0!==UM.fields_groups.field.conditional.fieldsList[i]){var d=a(this).val(),o=a(this).closest(".um-conditional-rule-fields");if(""===d)o.find(".um-conditional-rule-condition-col .um-conditional-rule-setting").prop("disabled",!0),o.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),o.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{d=a('.um-field-row[data-field="'+d+'"]').children(".um-field-row-order").val();let t=o.find(".um-conditional-rule-condition-col .um-conditional-rule-setting"),n=(t.prop("disabled",!1),t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[i][d].conditions,function(e,i){t.find('option[value="'+e+'"]').length||t.append('<option value="'+e+'">'+i+"</option>")}),null);null===UM.fields_groups.field.conditional.fieldsList[i][d].valueOptions?((n=o.find(".um-conditional-rule-value-col input.um-conditional-rule-setting")).prop("disabled",!1).show(),o.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide()):(n=o.find(".um-conditional-rule-value-col select.um-conditional-rule-setting"),o.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),n.prop("disabled",!1).show(),n.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[i][d].valueOptions,function(e,i){n.find('option[value="'+i.key+'"]').length||n.append('<option value="'+i.key+'">'+i.value+"</option>")})),t.val("").trigger("change"),n.val("").trigger("change")}}}),a(document.body).on("change",".um-conditional-rule-condition-col .um-conditional-rule-setting",function(e){var i,t,n,d=a(this).closest(".um-fields-column-content").data("uniqid");void 0!==UM.fields_groups.field.conditional.fieldsList[d]&&(i=a(this).val(),n=(t=a(this).closest(".um-conditional-rule-fields")).find(".um-conditional-rule-field-col .um-conditional-rule-setting").val(),n=a('.um-field-row[data-field="'+n+'"]').children(".um-field-row-order").val(),""===i||"!=empty"===i||"==empty"===i?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).val("").show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).val("").hide()):null===UM.fields_groups.field.conditional.fieldsList[d][n].valueOptions?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!1).val("").show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).val("").hide()):(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).val("").hide(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!1).val("").show()))}),a(document.body).on("change",".um-forms-field:not(.um-field-row-type-select)",function(e){var i=a(this).closest(".um-field-row").data("field"),t=a(this).closest("div[data-tab]").data("tab");UM.fields_groups.field.prepareSettings(a,i,t)}),a(document.body).on("focusin",".um-field-row-type-select",function(){a(this).closest(".um-field-row").data("previousValue",a(this).val())}).on("change",".um-field-row-type-select",function(){var e;a(this).hasClass("disabled")||(a(this).addClass("disabled").prop("disabled",!0),e=a(this).closest(".um-field-row"),UM.fields_groups.field.changeType(e,a))}),a(document.body).on("change",".um-field-row-title-input",function(e){var i=a(this).val(),t=(a(this).closest(".um-field-row").find("> .um-field-row-header > .um-field-row-title").text(UM.fields_groups.field.sanitizeInput(i)),a(this).closest(".um-form-table").find('> tbody > tr.um-forms-line[data-field_id="meta_key"] .um-field-row-metakey-input'));""===t.val()&&t.val(wp.url.cleanForSlug(i)).trigger("change"),UM.fields_groups.field.conditional.prepareFieldsList(a)}),a(document.body).on("change",".um-field-row-metakey-input",function(e){let i=wp.i18n.__("(no metakey)","ultimate-member");""!==a(this).val()&&(i=a(this).val()),a(this).closest(".um-field-row").find("> .um-field-row-header > .um-field-row-metakey").text(UM.fields_groups.field.sanitizeInput(i))}),a(document.body).on("click",".um-admin-option-bulk-toggle",function(){var e=a(this).parents(".um-admin-option-bulk-add-wrapper").siblings(".um-admin-option-bulk-add-list");e.is(":visible")?(e.slideUp(),a(this).text(a(this).data("show-label"))):(e.slideDown(),a(this).text(a(this).data("hide-label")))}),a(document.body).on("click",".um-admin-option-bulk-add",function(){if(!a(this).hasClass("disabled")){var o=a(this).data("bulk_value");let i=a(this).parents(".um-admin-option-bulk-add-list"),n=a(this).parents(".um-admin-option-bulk-add-list").siblings(".um-admin-option-rows"),d=a(this).parents(".um-admin-option-bulk-add-list").siblings(".um-admin-option-rows").find(".um-admin-option-row"),e=!1,t=(!(1<d.length)&&""===d.first().find(".um-admin-option-key").val()&&""===d.first().find(".um-admin-option-val").val()||(e=!0),!1);if((!e||confirm(wp.i18n.__("All current option will be removed. Are you sure you want to fill option by this preset?","ultimate-member")))&&(t=!0)){d.hide();let e=6<d.length?6:d.length;for(;0<e;){var l=a(".um-admin-option-row-skeleton-placeholder").clone().addClass("um-admin-option-row-skeleton").removeClass("um-admin-option-row-skeleton-placeholder");n.prepend(l),e--}i.siblings(".um-admin-option-bulk-add-wrapper").find(".um-admin-option-bulk-toggle").trigger("click"),i.find(".um-admin-option-bulk-add").addClass("disabled"),wp.ajax.send("um_fields_groups_get_options_preset",{data:{preset:o,nonce:um_admin_scripts.nonce},success:function(t){d.each(function(){a(this).find(".um-admin-option-row-remove").trigger("click")});let e=Object.keys(t.options).length-1;for(;0<e;)n.find(".um-admin-option-row").first().find(".um-admin-option-row-add").trigger("click"),e--;a.each(t.options,function(e){var i=Object.keys(t.options).indexOf(e);n.find(".um-admin-option-key:eq("+i+")").val(e),n.find(".um-admin-option-val:eq("+i+")").val(t.options[e])}),n.find(".um-admin-option-row-skeleton").remove(),d.show(),i.find(".um-admin-option-bulk-add").removeClass("disabled")},error:function(e){console.error(e)}})}}}),a(document.body).on("change",".um-field-row-multiple-input",function(){var e=a(this).closest(".um-field-row");um_multi_or_not(a(this),e)}),a(document.body).on("click",".um-admin-option-rows .um-admin-option-default",function(){var t=a(this).val();a(this).prop("checked",um_radioStates[t]=!um_radioStates[t]),a.each(a(".um-admin-option-rows .um-admin-option-default"),function(e,i){i.value!==t&&(um_radioStates[i.value]=!1)})}),a(document.body).on("click",".um-admin-option-row-add",function(){var e=a(this).parents(".um-field-row"),i=e.find(".um-field-row-multiple-input"),t=a(this).parents(".um-admin-option-row"),n=a(this).parents(".um-admin-option-rows"),d=n.siblings(".um-admin-option-row-placeholder")[0].outerHTML.replace("um-admin-option-row-placeholder","um-admin-option-row"),d=a("<div>").append(d);d.find(".um-admin-option-key").prop("disabled",!1),d.find(".um-admin-option-val").prop("disabled",!1),d.find(".um-admin-option-default").prop("disabled",!1),d.find(".um-admin-option-default-multi").prop("disabled",!1),d.find(".um-admin-option-row").insertAfter(t),um_recalculate_indexes(n),"both"===n.data("multiple")&&um_multi_or_not(i,e),um_admin_init_draggable(n)}),a(document.body).on("click",".um-admin-option-row-remove",function(){var e=a(this).parents(".um-admin-option-row"),i=a(this).parents(".um-admin-option-rows");1===a(this).parents(".um-admin-option-rows").find(".um-admin-option-row").length?(e.find(".um-admin-option-key").val(""),e.find(".um-admin-option-val").val(""),e.find(".um-admin-option-default").prop("checked",!1),e.find(".um-admin-option-default-multi").prop("checked",!1)):(e.remove(),um_recalculate_indexes(i),um_admin_init_draggable(i))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max"]'),i=parseFloat(a(this).val()),t=parseFloat(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min"]'),i=parseFloat(a(this).val()),t=parseFloat(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="date"][data-field_id="min"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="date"][data-field_id="max"]'),i=a(this).val(),t=e.val();""===i?e.removeAttr("min"):(e.attr("min",i),""!==t&&Date.parse(i)>Date.parse(t)&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="date"][data-field_id="max"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="date"][data-field_id="min"]'),i=a(this).val(),t=e.val();""===i?e.removeAttr("max"):(e.attr("max",i),""!==t&&Date.parse(i)<Date.parse(t)&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min_chars"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max_chars"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max_chars"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min_chars"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min_size"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max_size"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max_size"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min_size"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min_width"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max_width"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max_width"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min_width"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min_height"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max_height"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max_height"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min_height"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="min_rows"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="max_rows"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("min"):(e.attr("min",i),""!==e.val()&&t<i&&(e.val(i),a(this).attr("max",i)))}),a(document.body).on("change",'.um-forms-field[type="number"][data-field_id="max_rows"]',function(){var e=a(this).closest(".um-form-table").find('.um-forms-field[type="number"][data-field_id="min_rows"]'),i=parseInt(a(this).val()),t=parseInt(e.val());""===a(this).val()?e.removeAttr("max"):(e.attr("max",i),""!==e.val()&&i<t&&(e.val(i),a(this).attr("min",i)))});var e,i,t=a("#message[data-error-field]");0<t.length&&(e=t.data("error-field"),(e=a("#"+e)).is(":visible")||e.closest(".um-field-row:not(.um-field-row-edit-mode)").find("> .um-field-row-header > .um-field-row-actions > .um-field-row-action-edit").trigger("click"),e.is(":visible")||(i=e.closest(".um-form-table").parent().data("tab"),e.closest(".um-field-row.um-field-row-edit-mode").find('> .um-field-row-content > .um-field-row-tabs > div[data-tab="'+i+'"]').trigger("click")),e.addClass("um-error"),t[0].scrollIntoView())});