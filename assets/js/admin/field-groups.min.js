"undefined"==typeof um_admin_field_groups_data&&(um_admin_field_groups_data={}),"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.fields_groups&&(UM.fields_groups={}),UM.fields_groups={tabs:{setActive:function(e,i){var t=e.data("tab");let l=e.parents(".um-edit-field-tabs");l.find("div[data-tab]").removeClass("current"),e.addClass("current");let o=e.parents(".um-edit-field-tabs").siblings(".um-edit-field-tabs-content");o.find("div[data-tab]").removeClass("current"),o.find('div[data-tab="'+t+'"]').addClass("current")}},sortable:{init:function(t){t(".um-field-groups-fields-wrapper").sortable({items:".um-field-groups-field-row",connectWith:"um-field-groups-fields-wrapper",placeholder:"um-field-groups-field-placeholder",forcePlaceholderSize:!0,axis:"y",cursor:"move",handle:".um-field-groups-field-move-link",update:function(e,i){t(".um-field-groups-field-row").each(function(e){e=+e+1;t(this).find(".um-field-groups-field-order").val(e),t(this).find(".um-field-groups-field-row-header .um-field-groups-field-move-link").html(e)})}}).on("sortupdate",function(){t(".um-field-groups-field-row").each(function(e){e=+e+1;t(this).find(".um-field-groups-field-order").val(e),t(this).find(".um-field-groups-field-row-header .um-field-groups-field-move-link").html(e)})})},destroy:function(e){e(".um-field-groups-fields-wrapper").sortable("destroy")},reInit:function(e){UM.fields_groups.sortable.destroy(e),UM.fields_groups.sortable.init(e),e(".um-field-groups-fields-wrapper").trigger("sortupdate")}},field:{newIndex:0,add:function(f){let e=f(".um-field-groups-fields-wrapper"),i=f(".um-field-groups-field-row-template").clone().addClass("um-field-groups-field-row").removeClass("um-field-groups-field-row-template");UM.fields_groups.field.newIndex++;let c=UM.fields_groups.field.newIndex;i.data("field","new_"+c).attr("data-field","new_"+c);var t,l=e.find(".um-field-groups-field-row").length+1;i.find(".um-field-groups-field-move-link").html(l);let o=i.find(".um-field-groups-field-id");o.removeAttr("disabled").prop("disabled",!1);let d=o.attr("name");void 0!==d&&(t=d.replace("{index}",c),o.attr("name",t));let n=i.find(".um-field-groups-field-order");n.val(l).removeAttr("disabled").prop("disabled",!1);let u=n.attr("name");void 0!==u&&(l=u.replace("{index}",c),n.attr("name",l)),i.find(".um-form-table").each(function(e){let i=f(this).data("extra-class");void 0!==i&&(i=i.replace("{index}",c),i&&f(this).removeAttr("class").addClass("form-table um-form-table "+i))}),i.find(".um-forms-line").each(function(e){let i=f(this).data("prefix");var t,l,o;void 0!==i&&(t=i.replace("new_index","new_"+c),f(this).data("prefix",t).attr("data-prefix",t));let d=f(this).find("label"),n=d.attr("for");void 0!==n&&(t=n.replace("new_index","new_"+c),d.attr("for",t));let u=f(this).find(".um-forms-field"),a=u.attr("id");void 0!==a&&(l=a.replace("new_index","new_"+c),u.attr("id",l));let r=u.attr("name");void 0!==r&&(l=r.replace("{index}",c),u.attr("name",l)),u.removeAttr("disabled").prop("disabled",!1);let s=u.siblings('input[type="hidden"]');if(s.length){let e=s.attr("id");void 0!==e&&(o=e.replace("new_index","new_"+c),s.attr("id",o));let i=s.attr("name");void 0!==i&&(o=i.replace("{index}",c),s.attr("name",o)),s.removeAttr("disabled").prop("disabled",!1)}});let a=i.data("field");i.find(".um-conditional-rule-field-col .um-conditional-rule-setting").each(function(){f(this).find("option").each(function(){f(this).is(":selected")||""===f(this).attr("value")||f(this).remove()});let t=f(this);var e=t.val();f.each(UM.fields_groups.field.conditional.fieldsList,function(e,i){t.find('option[value="'+e+'"]').length||a==e||t.find('option[value=""]').after('<option value="'+e+'">'+i.title+"</option>")});let i=t.find("option").detach();i.sort(function(e,i){return""===f(e).val()?0:f(e).text()>f(i).text()?1:f(e).text()<f(i).text()?-1:0}),t.append(i).val(e)}),e.append(i),1<e.find(".um-field-groups-field-row").length?UM.fields_groups.sortable.reInit(f):(e.removeClass("hidden"),e.siblings(".um-field-groups-builder-header").removeClass("hidden"),e.siblings(".um-field-groups-fields-wrapper-empty").addClass("hidden"),UM.fields_groups.sortable.init(f)),UM.fields_groups.field.conditional.prepareFieldsList(f)},toggleEdit:function(e,i){e.hasClass("um-field-row-edit-mode")?UM.fields_groups.field.hideEdit(e,i):UM.fields_groups.field.showEdit(e,i)},showEdit:function(e,i){e.addClass("um-field-row-edit-mode")},hideEdit:function(e,i){e.removeClass("um-field-row-edit-mode")},duplicate:function(e,i){var t=e.parents(".um-field-groups-field-row").clone();e.parents(".um-field-groups-field-row").after(t),UM.fields_groups.sortable.reInit(i),UM.fields_groups.field.conditional.prepareFieldsList(i)},delete:function(e,i){let t=e.parents(".um-field-groups-fields-wrapper");e.parents(".um-field-groups-field-row").remove(),t.find(".um-field-groups-field-row").length?UM.fields_groups.sortable.reInit(i):(t.addClass("hidden"),t.siblings(".um-field-groups-builder-header").addClass("hidden"),t.siblings(".um-field-groups-fields-wrapper-empty").removeClass("hidden"),UM.fields_groups.sortable.destroy(i)),UM.fields_groups.field.conditional.prepareFieldsList(i)},conditional:{fieldsList:{},prepareFieldsList:function(e){e(".um-field-groups-fields-wrapper").find(".um-field-groups-field-row").each(function(){var t=e(this).data("field"),l=e(this).find(".um-field-groups-field-type-select").val(),o=e(this).find(".um-field-groups-field-title-input").val();if(um_admin_field_groups_data.field_types[l].conditional_rules.length){let i={};um_admin_field_groups_data.field_types[l].conditional_rules.forEach(e=>{i[e]=um_admin_field_groups_data.conditional_rules[e]});let e=null;"choice"===um_admin_field_groups_data.field_types[l].category&&(e={}),UM.fields_groups.field.conditional.fieldsList[t]={type:l,title:o,conditions:i,valueOptions:e}}})},reset:function(e,i){let t=e.parents('.um-edit-field-tabs-content > div[data-tab="conditional"]');t.find(".um-conditional-rules-wrapper .um-conditional-remove-rule").each(function(e){i(this).trigger("click")})},addRulesGroup:function(e,l){let i=e.siblings(".um-conditional-rules-group-template").clone().addClass("um-conditional-rules-group").removeClass("um-conditional-rules-group-template"),o=e.find(".um-conditional-rules-group").length;i.data("group-index",o).attr("data-group-index",o),i.find(".um-conditional-rule-setting").each(function(e){let i=l(this).attr("name");var t;void 0!==i&&(t=i.replace("{group_key}",o),l(this).attr("name",t),l(this).parents(".um-conditional-rule-field-col").length&&l(this).prop("disabled",!1).removeAttr("disabled"))}),e.find(".um-conditional-rules-wrapper-bottom").before(i),UM.fields_groups.field.conditional.showReset(e,l)},addRule:function(e,t){let i=e.parents(".um-conditional-rules-wrapper"),l=i.siblings(".um-conditional-rule-row-template").clone().addClass("um-conditional-rule-row").removeClass("um-conditional-rule-row-template"),o=e.parents(".um-conditional-rules-group").data("group-index"),d=e.parents(".um-conditional-rules-group").find(".um-conditional-rule-row").length;l.find(".um-conditional-rule-setting").each(function(e){let i=t(this).attr("name");if(void 0!==i){let e=i.replace("{group_key}",o);e=e.replace("{row_key}",d),t(this).attr("name",e),t(this).parents(".um-conditional-rule-field-col").length&&t(this).prop("disabled",!1).removeAttr("disabled")}}),e.after(l),UM.fields_groups.field.conditional.changeInputIndex(i,t),UM.fields_groups.field.conditional.showReset(i,t)},removeRule:function(e,i){let t=e.parents(".um-conditional-rules-wrapper"),l=t.find(".um-conditional-rule-row");if(1===l.length)return l.find(".um-conditional-rule-field-col select").val(""),l.find(".um-conditional-rule-condition-col select").val(""),l.find(".um-conditional-rule-value-col select,.um-conditional-rule-value-col input").val(""),void UM.fields_groups.field.conditional.hideReset(t,i);let o=e.parents(".um-conditional-rules-group");(1===o.find(".um-conditional-rule-row").length?o:e).remove(),UM.fields_groups.field.conditional.changeInputIndex(t,i)},changeInputIndex:function(e,l){let o=0;e.find(".um-conditional-rules-group").each(function(e){let t=0;l(this).find(".um-conditional-rule-row").each(function(e){l(this).find(".um-conditional-rule-setting").each(function(e){let i=l(this).data("base-name");if(void 0!==i){let e=i.replace("{group_key}",o);e=e.replace("{row_key}",t),l(this).attr("name",e)}}),t++}),l(this).data("group-index",o).attr("data-group-index",o),o++})},showReset:function(e,i){let t=e.parents('.um-edit-field-tabs-content > div[data-tab="conditional"]');t.find(".um-field-groups-field-reset-all-conditions").css({visibility:"visible"})},hideReset:function(e,i){let t=e.parents('.um-edit-field-tabs-content > div[data-tab="conditional"]');t.find(".um-field-groups-field-reset-all-conditions").css({visibility:"hidden"})},parseRules:function(e,i){let t=[];return e.find(".um-conditional-rule-field-col select,.um-conditional-rule-condition-col select,.um-conditional-rule-value-col select,.um-conditional-rule-value-col input").each(function(e){""!==i(this).val()&&t.push(i(this))}),t},isEmpty:function(e,i){return!UM.fields_groups.field.conditional.parseRules(e,i).length}},changeType:function(e,i){var t=e.find('.um-groups-fields-field-type-select option[value="'+e.find(".um-groups-fields-field-type-select").val()+'"]').html();e.find(".um-field-groups-field-type").html(t),UM.fields_groups.field.conditional.prepareFieldsList(i)}}},jQuery(function(o){UM.fields_groups.field.conditional.prepareFieldsList(o),o(".um-field-groups-fields-wrapper").find(".um-field-groups-field-row").each(function(){let l=o(this).data("field");o(this).find(".um-conditional-rule-field-col .um-conditional-rule-setting").each(function(){o(this).find("option").each(function(){o(this).is(":selected")||""===o(this).attr("value")||o(this).remove()});let t=o(this);var e=t.val();o.each(UM.fields_groups.field.conditional.fieldsList,function(e,i){t.find('option[value="'+e+'"]').length||l==e||t.find('option[value=""]').after('<option value="'+e+'">'+i.title+"</option>")});let i=t.find("option").detach();i.sort(function(e,i){return""===o(e).val()?0:o(e).text()>o(i).text()?1:o(e).text()<o(i).text()?-1:0}),t.append(i).val(e)})}),UM.fields_groups.sortable.init(o),o(document.body).on("click",".um-field-groups-field-row",function(e){void 0!==e.target&&e.target.classList.contains("um-field-groups-toggle-edit")&&(e.preventDefault(),UM.fields_groups.field.toggleEdit(o(this),o))}),o(document.body).on("click",".um-field-groups-field-edit",function(e){e.preventDefault();e=o(this).parents(".um-field-groups-field-row");UM.fields_groups.field.toggleEdit(e,o)}),o(document.body).on("click",".um-field-groups-field-delete",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure you want to delete this field?","ultimate-member"))&&UM.fields_groups.field.delete(o(this),o)}),o(document.body).on("click",".um-field-groups-field-duplicate",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure you want to duplicate this field?","ultimate-member"))&&UM.fields_groups.field.duplicate(o(this),o)}),o(document.body).on("click",".um-add-field-groups-field",function(e){e.preventDefault(),UM.fields_groups.field.add(o)}),o(document.body).on("click",".um-edit-field-tabs > div[data-tab]:not(.current)",function(e){e.preventDefault(),UM.fields_groups.tabs.setActive(o(this),o)}),o(document.body).on("click",".um-field-groups-field-reset-all-conditions",function(e){e.preventDefault(),confirm(wp.i18n.__("Are you sure?","ultimate-member"))&&UM.fields_groups.field.conditional.reset(o(this),o)}),o(document.body).on("click",".um-conditional-add-rules-group",function(e){e.preventDefault();e=o(this).parents(".um-conditional-rules-wrapper");UM.fields_groups.field.conditional.addRulesGroup(e,o)}),o(document.body).on("click",".um-conditional-add-rule",function(e){e.preventDefault();e=o(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.addRule(e,o)}),o(document.body).on("click",".um-conditional-remove-rule",function(e){e.preventDefault();e=o(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.removeRule(e,o)}),o(document.body).on("change",".um-conditional-rule-field-col select, .um-conditional-rule-condition-col select, .um-conditional-rule-value-col select,.um-conditional-rule-value-col input",function(e){var i=o(this).parents('.um-edit-field-tabs-content > div[data-tab="conditional"]');UM.fields_groups.field.conditional.isEmpty(i,o)?UM.fields_groups.field.conditional.hideReset(o(this),o):UM.fields_groups.field.conditional.showReset(o(this),o)}),o(document.body).on("change",".um-conditional-rule-field-col .um-conditional-rule-setting",function(e){var i=o(this).val();let l=o(this).parents(".um-conditional-rule-fields");if(""===i)l.find(".um-conditional-rule-condition-col .um-conditional-rule-setting").prop("disabled",!0),l.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),l.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{let t=l.find(".um-conditional-rule-condition-col .um-conditional-rule-setting");t.prop("disabled",!1),t.find("option").each(function(){""!==o(this).attr("value")&&o(this).remove()});t.val();o.each(UM.fields_groups.field.conditional.fieldsList[i].conditions,function(e,i){t.find('option[value="'+e+'"]').length||t.find('option[value=""]').after('<option value="'+e+'">'+i+"</option>")});let e=t.find("option").detach();e.sort(function(e,i){return""===o(e).val()?0:o(e).text()>o(i).text()?1:o(e).text()<o(i).text()?-1:0}),t.append(e).val(""),null===UM.fields_groups.field.conditional.fieldsList[i].valueOptions?(l.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),l.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide()):(l.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),l.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).show())}}),o(document.body).on("change",".um-conditional-rule-condition-col .um-conditional-rule-setting",function(e){var i=o(this).val();let t=o(this).parents(".um-conditional-rule-fields");var l=t.find(".um-conditional-rule-field-col .um-conditional-rule-setting").val();""===i||"!=empty"===i||"==empty"===i?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide()):null===UM.fields_groups.field.conditional.fieldsList[l].valueOptions?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!1).show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide()):(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!1).show())}),o(".um-conditional-rules-wrapper .um-conditional-rule-condition-col .um-conditional-rule-setting").trigger("change"),o(document.body).on("change",".um-field-groups-field-title-input",function(e){o(this).parents(".um-field-groups-field-row").find(".um-field-groups-field-title").html(o(this).val()),UM.fields_groups.field.conditional.prepareFieldsList(o)}),o(document.body).on("change",".um-field-groups-field-type-select",function(e){var i=o(this).parents(".um-field-groups-field-row");UM.fields_groups.field.changeType(i,o)})});