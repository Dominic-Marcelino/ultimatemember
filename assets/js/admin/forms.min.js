function um_admin_init_users_select(){if(jQuery(".um-user-select-field:visible:not(.um-select2-inited)").length){function e(e){var i;if(!e.id)return e.text;if(void 0!==e.img)i=jQuery('<span><img style="vertical-align: sub; width: 20px; height: 20px;" src="'+e.img+'" /> '+e.text+"</span>");else{let t;void 0!==e.element&&void 0!==e.element.attributes["data-img"]&&(t=e.element.attributes["data-img"].value),i=t?jQuery('<img style="vertical-align: sub; width: 20px; height: 20px;" src="'+t+'" /> '+e.text+"</span>"):jQuery("<span>"+e.text+"</span>")}return i}var i={ajax:{url:wp.ajax.settings.url,dataType:"json",delay:250,data:function(e){var i={action:"um_get_users",search:e.term,page:e.page||1,nonce:um_admin_scripts.nonce};return jQuery.each(jQuery(this)[0].attributes,function(){this.specified&&-1!==this.name.indexOf("data-ajax-args-")&&(i[this.name.replace("data-ajax-args-","").trim()]=this.value)}),i},processResults:function(e,i){i.page=i.page||1;var t=[];return e.data.users&&jQuery.each(e.data.users,function(e,i){void 0!==i.img?t.push({id:i.ID,text:i.user_login+" (#"+i.ID+")",img:i.img}):t.push({id:i.ID,text:i.user_login+" (#"+i.ID+")"})}),{results:t,pagination:{more:20*i.page<e.data.total_count}}},cache:!0},minimumInputLength:0,allowClear:!0,width:"100%",allowHtml:!0,dropdownCssClass:"um-select2-users-dropdown",containerCssClass:"um-select2-users-container",placeholder:jQuery(this).data("placeholder"),templateSelection:e,templateResult:e};let t=jQuery(".um-user-select-field:visible:not(.um-select2-inited)");t.each(function(){jQuery(this).hasClass("select2-hidden-accessible")&&jQuery(this).removeClass("um-select2-inited").select2("destroy")}),t.addClass("um-select2-inited").select2(i)}}function um_admin_init_pages_select(){jQuery(".um-pages-select2").select2({ajax:{url:wp.ajax.settings.url,dataType:"json",delay:250,data:function(e){return{search:e.term,action:"um_get_pages_list",page:e.page||1,nonce:um_admin_scripts.nonce}},processResults:function(e,i){i.page=i.page||1;var t=[];return e&&jQuery.each(e,function(e,i){"total_count"!==e&&t.push({id:i[0],text:i[1]})}),{results:t,pagination:{more:10*i.page<e.total_count}}},cache:!0},placeholder:jQuery(this).data("placeholder"),minimumInputLength:0,allowClear:!0})}function um_add_same_page_log(e,i){var t=jQuery(".um-same-page-update-"+e).find(".upgrade_log"),n=t.html();t.html(n+i+"<br />")}function um_same_page_wrong_ajax(e){um_add_same_page_log(e,wp.i18n.__("Wrong AJAX response...","ultimate-member")),um_add_same_page_log(e,wp.i18n.__("Your upgrade was crashed, please contact with support","ultimate-member"))}function um_same_page_something_wrong(e){um_add_same_page_log(e,wp.i18n.__("Something went wrong with AJAX request...","ultimate-member")),um_add_same_page_log(e,wp.i18n.__("Your upgrade was crashed, please contact with support","ultimate-member"))}jQuery(document).ready(function(){um_admin_init_users_select(),um_admin_init_pages_select(),jQuery(document.body).on("click",".um-forms-field[data-log-object]",function(){var e=jQuery(this).data("log-object");jQuery(this).is(":checked")?jQuery(this).parents("label").siblings(".um-same-page-update-"+e).show():jQuery(this).parents("label").siblings(".um-same-page-update-"+e).hide()}),jQuery(document.body).on("click",".um-admin-form-same-page-update",function(){var e=jQuery(this).data("upgrade_cb");if(jQuery(this).prop("disabled",!0),um_add_same_page_log(e,wp.i18n.__("Upgrade Process Started...","ultimate-member")),"sync_metatable"===e){var i,t=0;jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_same_page_update",cb_func:"um_usermeta_fields",nonce:um_admin_scripts.nonce},success:function(n){i=1,um_add_same_page_log(e,wp.i18n.__("Getting metadata","ultimate-member")),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_same_page_update",cb_func:"um_get_metadata",nonce:um_admin_scripts.nonce},success:function(n){void 0!==n.data.count?(um_add_same_page_log(e,wp.i18n.__("There are ","ultimate-member")+n.data.count+wp.i18n.__(" metadata rows...","ultimate-member")),um_add_same_page_log(e,wp.i18n.__("Start metadata upgrading...","ultimate-member")),t=Math.ceil(n.data.count/500),function n(){i<=t?jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_same_page_update",cb_func:"um_update_metadata_per_page",page:i,nonce:um_admin_scripts.nonce},success:function(t){void 0!==t.data?(um_add_same_page_log(e,t.data.message),i++,n()):um_same_page_wrong_ajax(e)},error:function(){um_same_page_something_wrong(e)}}):window.location=um_forms_data.successfully_redirect}()):um_same_page_wrong_ajax(e)},error:function(){um_same_page_something_wrong(e)}})},error:function(){um_same_page_something_wrong(e)}})}else wp.hooks.doAction("um_same_page_upgrade",e)}),jQuery(".um-sortable-items-field").sortable({items:".um-sortable-item",connectWith:".um-admin-drag-col,.um-admin-drag-group",forcePlaceholderSize:!0,update:function(e,i){var t=[];jQuery(this).find("li").each(function(){jQuery(this).hasClass("um-hidden-item")||t.push(jQuery(this).data("tab-id"))}),jQuery(this).siblings(".um-sortable-items-value").val(t.join(","))}}),jQuery(".um-multi-selects-list.um-sortable-multi-selects").sortable({items:".um-admin-drag-fld",connectWith:".um-admin-drag-col,.um-admin-drag-group",forcePlaceholderSize:!0}),jQuery('.um-multi-selects-list[data-field_id="_um_sorting_fields"] li').each(function(){"other"===jQuery(this).find(".um-field-wrapper:not(.um-custom-order-fields) select").val()?jQuery(this).find(".um-field-wrapper.um-custom-order-fields").show():jQuery(this).find(".um-field-wrapper.um-custom-order-fields").hide()}),jQuery('.um-forms-line[data-field_type="md_sorting_fields"] .um-multi-selects-add-option').on("click",function(){var e=jQuery(this).siblings("ul.um-multi-selects-list"),i=e.hasClass("um-sortable-multi-selects");e.data("field_id");var t=0;e.find("li:last select.um-forms-field").length>0&&(t=1*(t=e.find("li:last select.um-forms-field").attr("id").split("-"))[1]+1);var n=jQuery("<div>").append(e.siblings(".um-hidden-multi-selects").clone()).html(),a='<li class="um-multi-selects-option-line'+(i?" um-admin-drag-fld":"")+'">';i&&(a+='<span class="um-field-icon"><i class="um-faicon-sort"></i></span>');let s="";jQuery.each(um_forms_data.md_sorting_data_types,function(e,i){s+='<option value="'+e+'">'+i+"</option>"}),a+='<span class="um-field-wrapper">'+n+'</span><span class="um-field-control"><a href="javascript:void(0);" class="um-select-delete">'+wp.i18n.__("Remove","ultimate-member")+'</a></span><span class="um-field-wrapper um-custom-order-fields"><label>'+wp.i18n.__("Meta key","ultimate-member")+':&nbsp;<input type="text" name="meta_key" /></label></span><span class="um-field-wrapper um-custom-order-fields"><label>'+wp.i18n.__("Data type","ultimate-member")+':&nbsp;<select name="data_type" />'+s+'</select></label></span><span class="um-field-wrapper um-custom-order-fields"><label>'+wp.i18n.__("Order","ultimate-member")+':&nbsp;<select name="order" /><option value="ASC">'+wp.i18n.__("ASC","ultimate-member")+'</option><option value="DESC">'+wp.i18n.__("DESC","ultimate-member")+'</option></select></label></span><span class="um-field-wrapper um-custom-order-fields"><label>'+wp.i18n.__("Label","ultimate-member")+':&nbsp;<input type="text" name="label" /></label></span></li>',e.append(a),e.find("li:last .um-hidden-multi-selects").attr("name",jQuery(this).data("name")).addClass("um-forms-field um-long-field").removeClass("um-hidden-multi-selects").attr("id",e.data("id_attr")+"-"+t).trigger("change"),jQuery("#"+e.data("id_attr")+"-"+t).parents("li").find('.um-field-wrapper.um-custom-order-fields input[name="meta_key"]').attr("name","um_metadata[_um_sorting_fields][other_data]["+t+"][meta_key]"),jQuery("#"+e.data("id_attr")+"-"+t).parents("li").find('.um-field-wrapper.um-custom-order-fields input[name="label"]').attr("name","um_metadata[_um_sorting_fields][other_data]["+t+"][label]"),jQuery("#"+e.data("id_attr")+"-"+t).parents("li").find('.um-field-wrapper.um-custom-order-fields select[name="data_type"]').attr("name","um_metadata[_um_sorting_fields][other_data]["+t+"][data_type]"),jQuery("#"+e.data("id_attr")+"-"+t).parents("li").find('.um-field-wrapper.um-custom-order-fields select[name="order"]').attr("name","um_metadata[_um_sorting_fields][other_data]["+t+"][order]")}),jQuery(document.body).on("change",'.um-multi-selects-list[data-field_id="_um_sorting_fields"] .um-field-wrapper:not(.um-custom-order-fields) select',function(){"other"===jQuery(this).val()?jQuery(this).parents("li").find(".um-field-wrapper.um-custom-order-fields").show():jQuery(this).parents("li").find(".um-field-wrapper.um-custom-order-fields").hide()}),jQuery(document.body).on("click",".um-multi-selects-option-line .um-select-delete",function(){jQuery(this).parents("li.um-multi-selects-option-line").remove()}),jQuery(document.body).on("click",".um-md-default-filters-option-line .um-select-delete",function(){jQuery(this).parents("li.um-md-default-filters-option-line").remove()}),jQuery(".um-multi-selects-add-option").on("click",function(){if(!jQuery(this).parents('.um-forms-line[data-field_type="md_sorting_fields"]').length){var e=jQuery(this).siblings("ul.um-multi-selects-list"),i=e.hasClass("um-sortable-multi-selects");e.data("field_id");var t=0;e.find("li:last select.um-forms-field").length>0&&(t=1*(t=e.find("li:last select.um-forms-field").attr("id").split("-"))[1]+1);var n=jQuery("<div>").append(e.siblings(".um-hidden-multi-selects").clone()).html(),a='<li class="um-multi-selects-option-line'+(i?" um-admin-drag-fld":"")+'">';i&&(a+='<span class="um-field-icon"><i class="um-faicon-sort"></i></span>'),a+='<span class="um-field-wrapper">'+n+'</span><span class="um-field-control"><a href="javascript:void(0);" class="um-select-delete">'+wp.i18n.__("Remove","ultimate-member")+"</a></span></li>",e.append(a),e.find("li:last .um-hidden-multi-selects").attr("name",jQuery(this).data("name")).addClass("um-forms-field um-long-field").removeClass("um-hidden-multi-selects").attr("id",e.data("id_attr")+"-"+t)}});var e,i=-new Date().getTimezoneOffset()/60;jQuery('input[name="um-gmt-offset"]').val(i),jQuery(".um-admin-metabox").find(".um-slider").each(function(){var e=jQuery(this),i=parseInt(e.data("min")),t=parseInt(e.data("max"));void 0!==jQuery("#"+e.data("field_name")+"_min").val()&&(i=jQuery("#"+e.data("field_name")+"_min").val()),void 0!==jQuery("#"+e.data("field_name")+"_max").val()&&(t=jQuery("#"+e.data("field_name")+"_max").val());var a=[i,t];e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:a,create:function(e,i){},step:1,slide:function(e,i){n(jQuery(this),i)},stop:function(e,i){}}),n(e)}),jQuery(".um-admin-metabox").find(".um-datepicker-filter").each(function(){var e=jQuery(this),i=new Date(1e3*e.data("date_min")),t=new Date(1e3*e.data("date_max")),n=e.pickadate({selectYears:!0,min:i,max:t,formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){e.blur(),e.siblings(".picker").find(".picker__button--close").addClass("button")},onClose:function(){e.blur()},onSet:function(e){}}).pickadate("picker");e.data("value")&&n.set("select",1e3*e.data("value"))}),jQuery(".um-admin-metabox").find(".um-timepicker-filter").each(function(){var e=jQuery(this),i=e.data("min"),t=e.data("max"),n=i.split(":"),a=t.split(":");e.pickatime({format:e.data("format"),interval:parseInt(e.data("intervals")),min:[n[0],n[1]],max:[a[0],a[1]],formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()},onSet:function(e){}})});var t=!1;function n(e,i){var t,n,a="",s=e.siblings(".um-slider-range").data("placeholder-s"),o=e.siblings(".um-slider-range").data("placeholder-p");i?(a=i.values[0]===i.values[1]?s.replace("{value}",i.values[0]).replace("{field_label}",e.siblings(".um-slider-range").data("label")):o.replace("{min_range}",i.values[0]).replace("{max_range}",i.values[1]).replace("{field_label}",e.siblings(".um-slider-range").data("label")),t=i.values[0],n=i.values[1]):(a=e.slider("values",0)===e.slider("values",1)?s.replace("{value}",e.slider("values",0)).replace("{field_label}",e.siblings(".um-slider-range").data("label")):o.replace("{min_range}",e.slider("values",0)).replace("{max_range}",e.slider("values",1)).replace("{field_label}",e.siblings(".um-slider-range").data("label")),t=e.slider("values",0),n=e.slider("values",1)),e.siblings(".um-slider-range").html(a),e.siblings(".um_range_min").val(t),e.siblings(".um_range_max").val(n)}function a(){jQuery(".um-forms-line").removeClass("um-forms-line-conditioned").each(function(){void 0===jQuery(this).data("conditional")||jQuery(this).hasClass("um-forms-line-conditioned")||(function e(i){i.addClass("um-forms-line-conditioned");var t=i.data("conditional"),n=t[1],a=t[2],o=i.data("prefix"),l=!0;if("="===n||"!="===n){if(-1===t[0].indexOf("||")){var r=jQuery("#"+o+"_"+t[0]);void 0!==r.parents(".um-forms-line").data("conditional")&&(l=e(r.parents(".um-forms-line")))}}else if("~"===n){var d=t[0].split("|"),u=[];jQuery.each(d,function(e){u.push(jQuery("#"+o+"_"+d[e]))}),void 0!==u[0].parents(".um-forms-line").data("conditional")&&(l=e(u[0].parents(".um-forms-line")))}else if("><"===n){var r=jQuery("#"+o+"_"+t[0]+"_"+t[2]);void 0!==r.parents(".um-forms-line").data("conditional")&&(l=e(r.parents(".um-forms-line")))}var m=!1;if("="===n){if(-1!==t[0].indexOf("||")){var d=t[0].split("||"),c=!1;return jQuery.each(d,function(i){var t=jQuery("#"+o+"_"+d[i]);m=!1,l=!0,void 0!==t.parents(".um-forms-line").data("conditional")&&(l=e(t.parents(".um-forms-line")));var n=t.prop("tagName").toLowerCase();"input"===n?m="checkbox"===t.attr("type")?"1"==a?t.is(":checked"):!t.is(":checked"):Array.isArray(a)?-1!==a.indexOf(t.val()):t.val()==a:"select"===n&&(m=Array.isArray(a)?-1!==a.indexOf(t.val()):t.val()==a),m&&l&&(c=!0)}),c}var p=r.prop("tagName").toLowerCase();if("input"==p){var f=r.attr("type");m="checkbox"==f?"1"==a?r.is(":checked"):!r.is(":checked"):Array.isArray(a)?-1!==a.indexOf(r.val()):r.val()==a}else"select"==p&&(m=Array.isArray(a)?-1!==a.indexOf(r.val()):r.val()==a);return m&&l}if("!="===n){if(-1!==t[0].indexOf("||")){var d=t[0].split("||"),c=!1;return jQuery.each(d,function(i){var t=jQuery("#"+o+"_"+d[i]);m=!1,l=!0,void 0!==t.parents(".um-forms-line").data("conditional")&&(l=e(t.parents(".um-forms-line")));var n=t.prop("tagName").toLowerCase();"input"===n?m="checkbox"===t.attr("type")?"1"==a?!t.is(":checked"):t.is(":checked"):t.val()!=a:"select"===n&&(m=t.val()!=a),m&&l&&(c=!0)}),c}var p=r.prop("tagName").toLowerCase();if("input"==p){var f=r.attr("type");m="checkbox"==f?"1"==a?!r.is(":checked"):r.is(":checked"):r.val()!=a}else"select"==p&&(m=r.val()!=a);return m&&l}if("~"===n){var h,g,v=[];if("sortable_items"===i.data("field_type")){if(h=i.find(".um-sortable-items-value").data("field_id"),jQuery.each(u,function(e){var i=u[e],t=i.prop("tagName").toLowerCase();"input"===t?"checkbox"===i.attr("type")&&"1"==a&&i.is(":checked")&&v.push(i.data("fill_"+h)):"select"==t&&!a&&i.val()&&(v=(v=v.concat(i.val())).filter(s))}),g=jQuery('[data-field_id="'+h+'"]'),v.length){g.siblings(".um-sortable-items-field").find("li").addClass("um-hidden-item"),jQuery.each(v,function(e){g.siblings(".um-sortable-items-field").find('li[data-tab-id="'+v[e]+'"]').removeClass("um-hidden-item")});var b=[];g.siblings(".um-sortable-items-field").find("li").each(function(){jQuery(this).hasClass("um-hidden-item")||b.push(jQuery(this).data("tab-id"))}),g.val(b.join(",")),g.siblings(".um-sortable-items-field").sortable("refresh"),m=!0}else g.val(null)}else h=i.find(i.data("field_type")).data("field_id"),jQuery.each(u,function(e){var i=u[e],t=i.prop("tagName").toLowerCase();"input"===t?"checkbox"===i.attr("type")&&"1"==a&&i.is(":checked")&&v.push(i.data("fill_"+h)):"select"==t&&!a&&i.val()&&(v=(v=v.concat(i.val())).filter(s))}),g=jQuery('[data-field_id="'+h+'"]'),v.length?(g.find("option").hide(),jQuery.each(v,function(e){g.find('option[value="'+v[e]+'"]').show()}),-1===v.indexOf(g.val())&&(g.val(v[0]),g.find("option").attr("selected",!1).prop("selected",!1),g.find('option[value="'+v[0]+'"]').attr("selected",!0).prop("selected",!0)),m=!0):(g.val(null),g.find("option").attr("selected",!1).prop("selected",!1));return m&&l}if("><"===n){var p=r.prop("tagName").toLowerCase();if("input"==p){var f=r.attr("type");"checkbox"==f&&(m=r.is(":checked"))}return m&&l}return!1}(jQuery(this))?(jQuery(this).show(),um_admin_init_users_select()):jQuery(this).hide())})}function s(e,i,t){return t.indexOf(e)===i}jQuery(document.body).on("change",".um-md-default-filters-option-line .um-field-wrapper select",function(){if(!t){var e=jQuery(this),i=e.val(),a=e.data("member_directory");t=!0,wp.ajax.send("um_member_directory_default_filter_settings",{data:{key:i,directory_id:a,nonce:um_admin_scripts.nonce},success:function(i){var a=e.parents(".um-md-default-filters-option-line").find(".um-field-wrapper2");a.html(i.field_html),t=!1,a.find(".um-slider").each(function(){var e=jQuery(this),i=parseInt(e.data("min")),t=parseInt(e.data("max"));e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:[i,t],create:function(e,i){},step:1,slide:function(e,i){n(jQuery(this),i)},stop:function(e,i){}}),n(e)}),a.find(".um-datepicker-filter").each(function(){var e=jQuery(this),i=new Date(1e3*e.data("date_min")),t=new Date(1e3*e.data("date_max"));e.pickadate({selectYears:!0,min:i,max:t,formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){e.blur(),e.siblings(".picker").find(".picker__button--close").addClass("button")},onClose:function(){e.blur()},onSet:function(e){}})}),a.find(".um-timepicker-filter").each(function(){var e=jQuery(this),i=e.data("min"),t=e.data("max"),n=i.split(":"),a=t.split(":");e.pickatime({format:e.data("format"),interval:parseInt(e.data("intervals")),min:[n[0],n[1]],max:[a[0],a[1]],formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()},onSet:function(e){}})})},error:function(e){return!1}})}}),jQuery(".um-md-default-filters-add-option").on("click",function(){if(!t){var e=jQuery(this).siblings("ul.um-md-default-filters-list");e.data("field_id");var i=0;e.find("li:last select.um-forms-field").length>0&&(i=1*(i=e.find("li:last select.um-forms-field").attr("id").split("-"))[1]+1);var n=jQuery("<div>").append(e.siblings(".um-hidden-md-default-filters").clone()).html();e.append('<li class="um-md-default-filters-option-line"><span class="um-field-wrapper">'+n+'</span></span><span class="um-field-control"><a href="javascript:void(0);" class="um-select-delete">'+wp.i18n.__("Remove","ultimate-member")+'</a></span><span class="um-field-wrapper2 um"></li>'),e.find("li:last .um-hidden-md-default-filters").attr("name",jQuery(this).data("name")).addClass("um-forms-field um-long-field").removeClass("um-hidden-md-default-filters").attr("id",e.data("id_attr")+"-"+i),e.find("li:last .um-field-wrapper select").trigger("change")}}),jQuery(document.body).on("click",".um-text-delete",function(){jQuery(this).parents("li.um-multi-text-option-line").remove()}),jQuery(".um-multi-text-add-option").on("click",function(){var e=jQuery(this).siblings("ul.um-multi-text-list"),i=0;e.find("li:last input.um-forms-field").length>0&&(i=1*(i=e.find("li:last input.um-forms-field").attr("id").split("-"))[1]+1);var t=jQuery("<div>").append(e.siblings(".um-hidden-multi-text").clone()).html(),n=e.data("item_class");e.append('<li class="'+n+'"><span class="um-field-wrapper">'+t+'</span><span class="um-field-control"><a href="javascript:void(0);" class="um-text-delete">'+wp.i18n.__("Remove","ultimate-member")+"</a></span></li>"),e.find("li:last .um-hidden-multi-text").attr("name",jQuery(this).data("name")).addClass("um-forms-field um-long-field").removeClass("um-hidden-multi-text").attr("id",e.data("id_attr")+"-"+i)}),jQuery(".um-media-upload").each(function(){var e=jQuery(this).find(".um-forms-field"),i=e.data("default");""!=e.val()&&e.val()!=i?(e.siblings(".um-set-image").hide(),e.siblings(".um-clear-image").show(),e.siblings(".icon_preview").show()):(e.val()==i&&e.siblings(".icon_preview").show(),e.siblings(".um-set-image").show(),e.siblings(".um-clear-image").hide())}),"undefined"!=typeof wp&&wp.media&&wp.media.editor&&(jQuery(".um-set-image").on("click",function(i){var t=jQuery(this);i.preventDefault(),e&&e.remove(),(e=wp.media({title:t.data("upload_frame"),button:{text:wp.i18n.__("Select","ultimate-member")},multiple:!1})).on("select",function(){var i=e.state().get("selection").first().toJSON();t.siblings(".icon_preview").attr("src",i.url).show(),t.siblings(".um-forms-field").val(i.url),t.siblings(".um-media-upload-data-id").val(i.id),t.siblings(".um-media-upload-data-width").val(i.width),t.siblings(".um-media-upload-data-height").val(i.height),t.siblings(".um-media-upload-data-thumbnail").val(i.thumbnail),t.siblings(".um-media-upload-data-url").trigger("change"),t.siblings(".um-media-upload-url").val(i.url),t.siblings(".um-clear-image").show(),t.hide(),jQuery(document).trigger("um_media_upload_select",[t,i])}),e.open()}),jQuery(".icon_preview").on("click",function(e){jQuery(this).siblings(".um-set-image").trigger("click")}),jQuery(".um-clear-image").on("click",function(e){var i=jQuery(this),t=i.siblings(".um-forms-field").data("default");i.siblings(".um-set-image").show(),i.hide(),i.siblings(".icon_preview").attr("src",t),i.siblings(".um-media-upload-data-id").val(""),i.siblings(".um-media-upload-data-width").val(""),i.siblings(".um-media-upload-data-height").val(""),i.siblings(".um-media-upload-data-thumbnail").val(""),i.siblings(".um-forms-field").val(t),i.siblings(".um-media-upload-data-url").trigger("change"),i.siblings(".um-media-upload-url").val(t),jQuery(document).trigger("um_media_upload_clear",i)})),jQuery(document.body).on("change",".um-forms-field",function(){(jQuery(".um-forms-line[data-conditional*='\""+jQuery(this).data("field_id")+"\",']").length>0||jQuery(".um-forms-line[data-conditional*='"+jQuery(this).data("field_id")+"|']").length>0||jQuery(".um-forms-line[data-conditional*='|"+jQuery(this).data("field_id")+"']").length>0)&&a()}),a(),jQuery(".um-entities-conditions-wrap").on("change",".um-entities-conditions",function(){var e=jQuery(this).closest(".um-entities-conditions-row"),i=jQuery(this).find(":selected").val(),t=e.find(".um-entities-conditions").data("original");"none"===i?(e.find("select, input").removeAttr("name"),e.find(".um-entities-conditions-responce").removeAttr("disabled").removeAttr("multiple"),e.find(".um-entities-conditions-responce").html("")):jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_registered_entities_conditions",nonce:um_admin_scripts.nonce,option:i},success:function(n){"disabled"!==n.data?(e.find(".um-entities-conditions-responce").removeAttr("disabled"),e.find(".um-entities-conditions-responce").attr("multiple","multiple"),e.find(".um-entities-conditions-responce").html(n.data),e.find(".um-entities-conditions").attr("name",t+"["+i+"]"),e.find(".um-entities-conditions-responce").attr("name",t+"["+i+"][]")):(e.find(".um-entities-conditions-responce").attr("name"),e.find(".um-entities-conditions-responce").html(""),e.find(".um-entities-conditions-responce").removeAttr("multiple"),e.find(".um-entities-conditions-responce").attr("disabled","disabled"),e.find(".um-entities-conditions-responce").after('<input type="hidden" name="'+t+'[site]" value="1">'))},error:function(e){console.log(e)}})}),jQuery("#um_add_protection_rule").on("click",function(e){e.preventDefault();var i=jQuery(this).closest(".um-restriction-rule-content").find(".um-protection-include-wrap"),t=i.find(".um-entities-conditions-row:first").clone();t.find('.um-entities-conditions-responce option[value!="0"], input').remove(),t.find(".um-entities-conditions-responce option").html(""),t.find(".um-entities-conditions option").removeAttr("selected"),t.find(".um-entities-conditions, .um-entities-conditions-responce").removeAttr("name"),t.find(".um-entities-conditions-responce").removeAttr("multiple"),i.append(t),i.find(".um-entities-conditions-row:last").find("select").removeAttr("disabled"),i.find(".remove-row").removeAttr("disabled")}),jQuery("#um_add_exclusion_rule").on("click",function(e){e.preventDefault();var i=jQuery(this).closest(".um-restriction-rule-content").find(".um-protection-exclude-wrap"),t=jQuery(this).closest(".um-restriction-rule-content").find(".um-protection-include-wrap").find(".um-entities-conditions-row:first").clone();jQuery(this).closest(".um-restriction-rule-content").find(".um-forms-line").show(),t.find(".um-entities-conditions").attr("data-original","um_restriction_rule_content[_um_exclude]"),t.find(".um-entities-conditions").attr("data-field_id","_um_exclude"),t.find(".um-entities-conditions").removeClass("um-protection-include").addClass("um-protection-exclude"),t.find(".um-entities-conditions-responce").attr("data-original","um_restriction_rule_content[_um_include]"),t.find(".um-entities-conditions-responce").attr("data-field_id","_um_exclude"),t.find(".um-entities-conditions-responce").removeClass("um-protection-include").addClass("um-protection-exclude"),t.find('.um-entities-conditions-responce option[value!="0"], input').remove(),t.find(".um-entities-conditions-responce option").html(""),t.find(".um-entities-conditions option").removeAttr("selected"),t.find(".um-entities-conditions, .um-entities-conditions-responce").removeAttr("name"),t.find(".um-entities-conditions-responce").removeAttr("multiple"),i.append(t),i.find(".um-entities-conditions-row:last").find("select").removeAttr("disabled"),i.find(".remove-row").removeAttr("disabled")}),jQuery(".um-entities-conditions-wrap").on("click",".remove-row",function(e){e.preventDefault();var i=jQuery(this).closest(".um-entities-conditions-wrap"),t=jQuery(this).closest(".um-entities-conditions-row");i.find(".um-entities-conditions-row").length>1?t.remove():(i.find("select").removeAttr("disabled").removeAttr("multiple"),i.find("select option").removeAttr("selected"),i.find(".um-entities-conditions-responce").html(""),i.find("input").remove(),jQuery(this).closest(".um-protection-include-wrap").length&&(jQuery(".um-protection-exclude-wrap").closest(".um-forms-line").hide(),jQuery("#um_add_exclusion_rule").attr("disabled","disabled"),jQuery(".um-protection-exclude-wrap .um-entities-conditions-row").remove()))}),1>jQuery(".um-protection-include-wrap .um-entities-conditions-row").length||(0===parseInt(jQuery(".um-protection-include-wrap .um-entities-conditions-row .um-entities-conditions-responce").val())?(jQuery(".um-protection-exclude-wrap").closest(".um-forms-line").hide(),jQuery("#um_add_exclusion_rule").attr("disabled","disabled")):jQuery(".um-protection-exclude-wrap").closest(".um-forms-line").show()),jQuery(document).on("change",".um-protection-include-wrap .um-entities-conditions-responce",function(){var e=!0;jQuery(".um-protection-include-wrap .um-entities-conditions-responce").each(function(){var i=jQuery(this).val();if(null===i&&(i=1),Array.isArray(i)){if(0!==i.length){e=!1;return}}else if(0!==parseInt(i)&&null!==i){e=!1;return}}),!1===e?jQuery("#um_add_exclusion_rule").removeAttr("disabled","disabled"):(jQuery(".um-protection-exclude-wrap").closest(".um-forms-line").hide(),jQuery("#um_add_exclusion_rule").attr("disabled","disabled"),jQuery(".um-protection-exclude-wrap .um-entities-conditions-row").remove())}),jQuery(document).on("change",".um-protection-include-wrap .um-entities-conditions",function(){var e=!1;"site"===jQuery(this).val()?e=!0:jQuery(this).find(".um-entities-conditions-responce").each(function(){if(0!==parseInt(jQuery(this).val()))return}),!0===e?jQuery("#um_add_exclusion_rule").removeAttr("disabled","disabled"):(jQuery(".um-protection-exclude-wrap").closest(".um-forms-line").hide(),jQuery("#um_add_exclusion_rule").attr("disabled","disabled"),jQuery(".um-protection-exclude-wrap .um-entities-conditions-row").remove())}),jQuery(".um-users-conditions-wrap").on("change",".um-users-conditions",function(){var e=jQuery(this).closest(".um-users-conditions-row"),i=jQuery(this).find(":selected").val(),t=jQuery(this).closest(".um-users-conditions-row-group").attr("data-group"),n=e.find(".um-users-conditions").data("original");"none"===i?(e.find("select").removeAttr("name"),e.find(".um-users-conditions-responce").removeAttr("multiple"),e.find(".um-users-conditions-responce").html("")):jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_registered_users_conditions",nonce:um_admin_scripts.nonce,option:i},success:function(a){"auth"!==i?e.find(".um-users-conditions-responce").attr("multiple","multiple"):e.find(".um-users-conditions-responce").removeAttr("multiple"),e.find(".um-users-conditions").attr("name",n+"["+parseInt(t)+"]["+i+"]"),e.find(".um-users-conditions-compare").attr("name",n+"["+parseInt(t)+"]["+i+"][compare]"),e.find(".um-users-conditions-responce").attr("name",n+"["+parseInt(t)+"]["+i+"][ids][]"),e.find(".um-users-conditions-responce").html(a.data)},error:function(e){console.log(e)}})}),jQuery(".um-users-conditions-wrap").on("click",".add-row",function(e){e.preventDefault();var i=jQuery(this).closest(".um-users-conditions-row-group"),t=i.find(".um-users-conditions-row:first").clone();t.find('.um-users-conditions-responce option[value!="0"]').remove(),t.find(".um-users-conditions-responce option").html(""),t.find(".um-users-conditions option").removeAttr("selected"),t.find(".um-users-conditions,.um-users-conditions-compare , .um-users-conditions-responce").removeAttr("name"),t.find(".um-users-conditions-responce").removeAttr("multiple"),t.find(".um-users-conditions-compare option:first").prop("selected",!0),i.append(t),i.find(".remove-row").removeAttr("disabled")}),jQuery(".um-users-conditions-wrap").on("click",".remove-row",function(e){e.preventDefault();var i=jQuery(this).closest(".um-users-conditions-wrap"),t=jQuery(this).closest(".um-users-conditions-row");i.find(".um-users-conditions-row").length>1?t.remove():(t.find(".um-users-conditions option, .um-entities-conditions-responce option").removeAttr("selected"),i.find(".um-users-conditions-row").find("select").removeAttr("disabled").removeAttr("multiple"),i.find('.um-users-conditions-responce option[value!="0"]').remove(),i.find(".um-users-conditions-responce option").html("")),i.find(".um-users-conditions-row").length>1&&t.remove(),jQuery(".um-users-conditions-row-group").each(function(){if(0===jQuery(this).find(".um-users-conditions-row").length){var e=jQuery(this).nextAll(".um-users-conditions-row-group");jQuery(this).remove(),e&&e.each(function(){var e=jQuery(this).attr("data-group"),i=jQuery(this).find(".um-users-conditions").attr("name"),t=jQuery(this).find(".um-users-conditions-compare").attr("name"),n=jQuery(this).find(".um-users-conditions-responce").attr("name"),a=parseInt(e)-1;if(jQuery(this).attr("data-group",a),i){var s=i.replace(e,a);jQuery(this).find(".um-users-conditions").attr("name",s)}if(t){var o=t.replace(e,a);jQuery(this).find(".um-users-conditions-compare").attr("name",o)}if(n){var l=n.replace(e,a);jQuery(this).find(".um-users-conditions-responce").attr("name",l)}})}})}),jQuery(".um-users-conditions-wrap").on("click",".add-group-row",function(e){e.preventDefault();var i=jQuery(this).closest(".um-users-conditions-wrap"),t=jQuery(".um-users-conditions-row-group:first").clone(),n=jQuery(".um-users-conditions-row-group:last").attr("data-group");t.find(".um-users-conditions-row").not(":first").remove(),t.find('.um-users-conditions-responce option[value!="0"]').remove(),t.find(".um-users-conditions-responce option").html(""),t.find(".um-users-conditions option").removeAttr("selected"),t.find(".um-users-conditions,.um-users-conditions-compare , .um-users-conditions-responce").removeAttr("name"),t.find(".um-users-conditions-responce").removeAttr("multiple"),t.find(".um-users-conditions-compare option:first").prop("selected",!0),t.attr("data-group",parseInt(n)+1),jQuery(this).closest(".um-conditions-group-action-wrap").before(t),i.find(".um-conditions-row-action").removeAttr("disabled")}),jQuery("#um-restriction-rules #the-list").sortable({update:function(e,i){var t={};jQuery("#um-restriction-rules #the-list tr").each(function(e){t[jQuery(this).find(".check-column input").val()]=e}),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:"um_restriction_rules_order",nonce:um_admin_scripts.nonce,indexes:t},success:function(e){},error:function(e){console.log(e)}})}})});
