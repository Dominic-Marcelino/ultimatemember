function um_time_convert(e,t){var r=Math.floor(e/60),e=e%60;return(r=60<=e&&(e=0,24<=(r+=1))?0:r)+":"+(e=e<10?"0"+e:e)}function um_build_template(e,t){var r=e.data("view_type"),a=UM.frontend.directories.getHash(e);jQuery(".um-"+a).length&&(e.find(".um-members-wrapper").html("").prepend(t["content_"+r]),""!==t.counter?e.find(".um-members-counter").text(t.counter).show():e.find(".um-members-counter").text(t.counter).hide(),e.addClass("um-loaded"),jQuery(document).trigger("um_build_template",[e,t]),jQuery(window).trigger("resize"),wp.hooks.doAction("um_member_directory_build_template",e),UM.common.tipsy.init())}"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.frontend&&(UM.frontend={}),UM.frontend.directories={list:[],getHash:function(e){return e.data("hash")},filtersHash:function(t){let r=0;for(let e=0;e<t.length;e++){var a=t.charCodeAt(e);r=(r<<5)-r+a,r|=0}return r},filters:{checkEmpty:function(e){var t=e.find(".um-clear-filters-a"),e=e.find(".um-search-filter-field");let a=0;return e.each(function(){var e,t,r=jQuery(this).parents(".um-search-filter").data("filter-type");"text"===r?""===jQuery(this).val()&&a++:"select"===r?0===jQuery(this).val().length&&a++:"slider"===r?(t=(e=jQuery(this).parents(".um-range-container")).find(".um-from-slider")[0],e=e.find(".um-to-slider")[0],parseInt(t.value,10)===parseInt(t.min,10)&&parseInt(e.value,10)===parseInt(e.max,10)&&a++):"datepicker"===r?(e=(t=jQuery(this).parents(".um-date-range-row")).find('[data-range="from"]'),t=t.find('[data-range="to"]'),""===e.val()&&""===t.val()&&a++):"timepicker"===r&&(t=(e=jQuery(this).parents(".um-time-range-row")).find('[data-range="from"]'),r=e.find('[data-range="to"]'),""===t.val())&&""===r.val()&&a++}),e.length===a?t.addClass("um-hidden").prop("disabled",!0):t.removeClass("um-hidden").prop("disabled",!1),e.length===a}}},UM.frontend.directory=function(e){this.hash=e,this.wrapper=jQuery('.um-directory[data-hash="'+e+'"]'),this.defaultOrder=this.wrapper.data("default-order")},UM.frontend.directory.prototype={hash:"",wrapper:null,busy:!1,lastResponse:null,page:1,totalPages:0,search:"",order:"",defaultOrder:"",filters:{},getDataFromURL:function(e){let t=this.hash,r={},a=UM.frontend.url.parseData();if(jQuery.each(a,function(e){-1!==e.indexOf("_"+t)&&""!==a[e]&&(r[e.replace("_"+t,"")]=a[e])}),!e)return r;if(void 0!==r[e])try{r[e]=decodeURIComponent(r[e])}catch(e){console.error(e)}return r[e]},setDataToURL:function(t,r){let a=this.hash,i=this.getDataFromURL(),s={},n=(Array.isArray(r)?(jQuery.each(r,function(e){r[e]=encodeURIComponent(r[e])}),r=r.join("||")):Number.isFinite(r)||(r=r.split("||"),jQuery.each(r,function(e){r[e]=encodeURIComponent(r[e])}),r=r.join("||")),""!==r&&(s[t+"_"+a]=r),jQuery.each(i,function(e){t===e?""!==r&&(s[e+"_"+a]=r):s[e+"_"+a]=i[e]}),jQuery.each(UM.frontend.directories.list,function(r){if(r!==a){let t=UM.frontend.directories.list[r].getDataFromURL();jQuery.each(t,function(e){s[e+"_"+r]=t[e]})}}),[]),e=(jQuery.each(s,function(e){n.push(e+"="+s[e])}),"?"+(n=wp.hooks.applyFilters("um_member_directory_url_attrs",n)).join("&"));"?"===e&&(e=""),window.history.pushState("string","UM Member Directory",window.location.origin+window.location.pathname+e)},setLastResponse:function(e){this.lastResponse=e},setTotalPages:function(e){this.totalPages=e},getLastResponse:function(){return this.lastResponse},isBusy:function(){return this.busy},getHash:function(){return this.hash},getWrapper:function(){return this.wrapper},preloaderShow:function(){this.busy=!0,this.wrapper.addClass("um-processing")},preloaderHide:function(){this.busy=!1,this.wrapper.removeClass("um-processing")},getPage:function(){return this.page},setPage:function(e,t=!1){e=(e=parseInt(e))||1;var r=parseInt(this.wrapper.data("total_pages"));r&&(e=e<=(r=r||1)?e:r),this.page=e,t||(1===e?this.setDataToURL("page",""):this.setDataToURL("page",e))},getOrder:function(){return this.order},setOrder:function(e,t=!1){this.order=e,t||(this.defaultOrder===e?this.setDataToURL("sort",""):this.setDataToURL("sort",e))},getSearch:function(){return this.search},setSearch:function(e,t=!1){this.search=e,t||(""===e?this.setDataToURL("search",""):this.setDataToURL("search",e))},hasSearched:function(){return this.getSearch()&&this.getFilters().length},getFilters:function(){return this.filters},applyFilters:function(o=!1){let d=this;var e=d.wrapper.find(".um-filters-form").find(".um-search-filter-field");let u={};e.each(function(){var r=jQuery(this).parents(".um-search-filter"),e=r.data("filter-type"),r=r.data("filter-name");if("text"===e){var a=UM.common.form.sanitizeValue(jQuery(this).val());""!==a&&(u[r]=a),o||d.setDataToURL("filter_"+r,a)}else if("select"===e){var i=jQuery(this).val();let t=[];for(let e=0;e<i.length;e++)t[e]=UM.common.form.sanitizeValue(i[e]);0!==t.length&&(u[r]=t),t=t.length?t.join("||"):"",o||d.setDataToURL("filter_"+r,t)}else if("slider"===e){var a=jQuery(this).parents(".um-range-container"),s=a.find(".um-from-slider")[0],a=a.find(".um-to-slider")[0],n=parseInt(s.value,10);let e;e=parseInt(s.value,10)===parseInt(s.min,10)?"":parseInt(s.value,10);var s=parseInt(a.value,10);let t;t=parseInt(a.value,10)===parseInt(a.max,10)?"":parseInt(a.value,10),""===e&&""===t||(u[r]=[n,s]),o||(d.setDataToURL("filter_"+r+"_from",e),d.setDataToURL("filter_"+r+"_to",t))}else"datepicker"===e?(n=(a=jQuery(this).parents(".um-date-range-row")).find('[data-range="from"]'),s=a.find('[data-range="to"]'),a=UM.common.form.sanitizeValue(n.val()),n=UM.common.form.sanitizeValue(s.val()),""===a&&""===n||(u[r]=[a,n]),o||(d.setDataToURL("filter_"+r+"_from",a),d.setDataToURL("filter_"+r+"_to",n))):"timepicker"===e&&(a=(s=jQuery(this).parents(".um-time-range-row")).find('[data-range="from"]'),n=s.find('[data-range="to"]'),e=UM.common.form.sanitizeValue(a.val()),s=UM.common.form.sanitizeValue(n.val()),""===e&&""===s||(u[r]=[e,s]),o||(d.setDataToURL("filter_"+r+"_from",e),d.setDataToURL("filter_"+r+"_to",s)))}),this.filters=u},resetFilters:function(){this.filters={};let a=this;a.wrapper.find(".um-filters-form").find(".um-search-filter-field").each(function(){var e=jQuery(this).parents(".um-search-filter"),t=e.data("filter-type"),r=e.data("filter-name");console.log("-----------------"),console.log(e),console.log(t),console.log(r),"text"===t||"select"===t?a.setDataToURL("filter_"+r,""):"slider"!==t&&"datepicker"!==t&&"timepicker"!==t||(a.setDataToURL("filter_"+r+"_from",""),a.setDataToURL("filter_"+r+"_to",""))})},request:function(e){if(this.preloaderShow(),this.wrapper.find(".um-member-directory-must-search").addClass("um-display-none"),this.wrapper.find(".um-member-directory-empty-search-result").addClass("um-display-none"),this.wrapper.find(".um-member-directory-empty-no-search-result").addClass("um-display-none"),this.wrapper.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!0),this.wrapper.find(".um-member-view-switcher").addClass("um-disabled"),void 0!==e&&e.hasOwnProperty("pagination")&&!1!==e.pagination||(this.wrapper.find(".um-members-wrapper").addClass("um-display-none"),this.wrapper.find(".um-members-pagination-box").addClass("um-display-none")),wp.hooks.applyFilters("um_member_directory_get_members_allow",!0,this)){var r,a=-(new Date).getTimezoneOffset()/60,i={directory_id:this.getHash(),page:this.getPage(),search:this.getSearch(),sorting:this.getOrder(),gmt_offset:a,post_refferer:this.wrapper.data("base-post"),nonce:this.wrapper.data("nonce")},s=(console.log(this.getFilters()),this.getFilters());for(r in s)i[r]=s[r];i=wp.hooks.applyFilters("um_member_directory_filter_request",i);let t=this;wp.ajax.send("um_get_members",{data:i,success:function(e){t.setLastResponse(e),t.setTotalPages(e.total_pages),um_build_template(t.wrapper,e),t.wrapper.find(".um-members-pagination-box").html(e.pagination),t.wrapper.data("total_pages",e.total_pages),(e.total_pages?(t.wrapper.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!1),t.wrapper.find(".um-member-view-switcher").removeClass("um-disabled"),t.wrapper.find(".um-member-directory-header").removeClass("um-display-none"),t.wrapper.find(".um-members-wrapper").removeClass("um-display-none"),t.wrapper.find(".um-members-pagination-box")):t.hasSearched()?t.wrapper.find(".um-member-directory-empty-search-result"):t.wrapper.find(".um-member-directory-empty-no-search-result")).removeClass("um-display-none"),wp.hooks.doAction("um_member_directory_loaded",t.wrapper,e),um_init_new_dropdown(),UM.frontend.slider.init(),t.preloaderHide()},error:function(e){console.log(e),(t.hasSearched()?t.wrapper.find(".um-member-directory-empty-search-result"):t.wrapper.find(".um-member-directory-empty-no-search-result")).removeClass("um-display-none"),t.preloaderHide()}})}else setTimeout(this.request,600,e)}},jQuery(document.body).ready(function(){function t(e){var t,r=UM.frontend.directories.getHash(e),r=UM.frontend.directories.list[r];r.isBusy()||(t=r.getDataFromURL("search"),(e=UM.common.form.sanitizeValue(e.find(".um-search-line").val()))===t)||""===e&&void 0===t||(r.setSearch(e),r.setPage(1),r.request())}function n(e,t,r){var a=e.find('.um-pagination-item[data-page="prev"]'),e=e.find('.um-pagination-item[data-page="next"]');(1===t?(a.addClass("disabled"),e):t===r?(e.addClass("disabled"),a):(a.removeClass("disabled"),e)).removeClass("disabled")}jQuery(document.body).on("click",".um-directory .um-member-view-switcher:not(.um-disabled) .um-button-in-group:not(.current)",function(){var e,t=jQuery(this),r=t.parents(".um-directory"),a=UM.frontend.directories.getHash(r),a=UM.frontend.directories.list[a];a.isBusy()||null!==(a=a.getLastResponse())&&(e=t.parents(".um-member-view-switcher").find(".um-button-in-group.current").data("type"),r.find(".um-members-wrapper.um-members-"+e).removeClass("um-members-"+e),t.parents(".um-member-view-switcher").find(".um-button-in-group").removeClass("current"),t.addClass("current"),e=t.data("type"),t=t.data("default"),r.find(".um-members-wrapper").addClass("um-members-"+e),t?um_set_url_from_data(r,"view_type",""):um_set_url_from_data(r,"view_type",e),r.data("view_type",e),um_build_template(r,a),um_init_new_dropdown())}),jQuery(document.body).on("click",".um-directory .um-do-search",function(){t(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("keypress",".um-directory .um-search-line",function(e){13===e.which&&t(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("click",".um-members-sorting",function(e){var t,r,a;e.preventDefault(),1===jQuery(this).data("selected")||(e=jQuery(this).data("directory-hash"),(e=UM.frontend.directories.list[e]).isBusy())||(t=e.getWrapper(),r=jQuery(this).text(),a=jQuery(this).data("value"),t.find('.um-dropdown[data-element=".um-members-sorting-toggle"]').find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),t.find('.um-dropdown[data-element=".um-members-sorting-toggle"] a[data-value="'+a+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),t.find(".um-members-sorting-toggle .um-button-content").text(r),e.setOrder(a),e.request())}),jQuery(document.body).on("click",".um-directory .um-pagination-item:not(.current)",function(){if(!jQuery(this).hasClass("disabled")){var t=jQuery(this).parents(".um-directory"),r=UM.frontend.directories.getHash(t),r=UM.frontend.directories.list[r];if(!r.isBusy()){var a=parseInt(t.data("total_pages")),i=r.getPage(),s=jQuery(this).data("page");let e;n(t,e="prev"===s?i-1:"next"===s?i+1:parseInt(s),a),t.find(".um-pagination-item").removeClass("current"),t.find('.um-pagination-item[data-page="'+e+'"]').addClass("current"),r.setPage(e),r.request({pagination:!0})}}}),jQuery(document.body).on("change",".um-directory .um-pagination-current-page-input",function(){if(!jQuery(this).hasClass("disabled")){var t=jQuery(this).parents(".um-directory"),r=UM.frontend.directories.getHash(t),r=UM.frontend.directories.list[r];if(!r.isBusy()){var a=r.getPage();let e=parseInt(jQuery(this).val());var i=parseInt(t.data("total_pages"));a!==e&&(e<1&&(jQuery(this).val(1),e=1),e>i&&(jQuery(this).val(i),e=i),n(t,e,i),r.setPage(e),r.request({pagination:!0}))}}}),jQuery(document.body).on("keypress",".um-directory .um-pagination-current-page-input",function(e){if(13===e.which)return jQuery(this).trigger("change"),!1}),jQuery(document.body).on("change",".um-search-filter-field",function(){var e=jQuery(this).parents(".um-filters-form"),t=e.find(".um-apply-filters");UM.frontend.directories.filters.checkEmpty(e),t.prop("disabled",!1)}),jQuery(document.body).on("reset",".um-directory .um-filters-form",function(){var e,t,r=jQuery(this).parents(".um-directory"),r=UM.frontend.directories.getHash(r),r=UM.frontend.directories.list[r];r.isBusy()||(e=(t=jQuery(this)).find(".um-clear-filters-a"),t=t.find(".um-apply-filters"),e.addClass("um-hidden").prop("disabled",!0),t.prop("disabled",!0),r.resetFilters(),r.setPage(1),r.request())}),jQuery(document.body).on("click",".um-directory .um-apply-filters",function(e){e.preventDefault();e=jQuery(this).parents(".um-directory"),e=UM.frontend.directories.getHash(e),e=UM.frontend.directories.list[e];e.isBusy()||(e.applyFilters(),e.setPage(1),e.request())}),wp.hooks.doAction("um_member_directory_on_first_pages_loading"),jQuery(".um-directory").each(function(){var e=jQuery(this),t=UM.frontend.directories.getHash(e),r=new UM.frontend.directory(t),t=(UM.frontend.directories.list[t]=r,wp.hooks.doAction("um_member_directory_on_init",e,t),r.getDataFromURL("page")),t=(r.setPage(t,!0),r.getDataFromURL("search")),t=(r.setSearch(t,!0),r.getDataFromURL("sort")),t=(r.setOrder(t,!0),r.applyFilters(!0),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!1===t&&1===parseInt(e.data("must-search")))return;wp.hooks.applyFilters("um_member_directory_prevent_default_request",!1,r)||r.request({defaultRequest:!0})}),window.addEventListener("popstate",function(e){jQuery(".um-directory").each(function(){var e=jQuery(this),t=UM.frontend.directories.getHash(e),r=new UM.frontend.directory(t),a=(UM.frontend.directories.list[t]=r).getDataFromURL("page"),i=r.getDataFromURL("search"),s=r.getDataFromURL("sort");r.applyFilters(!0),r.setPage(a,!0),r.setSearch(i,!0),r.setOrder(s,!0),e.find(".um-member-directory-sorting").length&&(void 0===(a=um_get_data_for_directory(e,"sort"))&&(a=e.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]').find('a[data-default="1"]').data("value")),(i=e.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]')).find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),i.find('a[data-value="'+a+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),e.find(".um-member-directory-sorting-a").find("> a").html(i.find('a[data-value="'+a+'"]').html())),e.find(".um-member-directory-view-type").length&&(void 0===(s=um_get_data_for_directory(e,"view_type"))&&(s=e.find('.um-member-directory-view-type-a[data-default="1"]').data("type")),e.data("view_type",s),e.find(".um-member-directory-view-type .um-member-directory-view-type-a").hide(),e.find('.um-member-directory-view-type .um-member-directory-view-type-a[data-type="'+s+'"]').show());wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e)||1===e.data("must-search")&&e.find(".um-member-directory-must-search").removeClass("um-display-none"),wp.hooks.applyFilters("um_member_directory_prevent_default_first_loading",!1,e,t)||r.request()})})}),wp.hooks.addFilter("um_toggle_block","um_member_directory",function(e,t){var r,a;return t.hasClass("um-meta-toggle")?(e=t.parents(".um-member").find(t.data("um-toggle")),r=t.data("toggle-text"),a=t.text(),t.data("toggle-text",a).text(r)):t.hasClass("um-filters-toggle")&&(e=t.parents(".um-directory").find(t.data("um-toggle"))),e});