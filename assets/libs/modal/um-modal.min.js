!function(d){function t(){this.M=[],this.defaultOptions={attributes:{},classes:"",duration:400,footer:"",header:"",size:"normal",template:"",content:""},this.defaultTemplate='<div class="um um-modal"><span class="um-modal-close">&times;</span><div class="um-modal-header"></div><div class="um-modal-body"></div><div class="um-modal-footer"></div></div>'}t.prototype={constructor:t,addModal:function(e,t){e=this.filterOptions(e);let n;if(e.template){let t=wp.template(e.template);t&&(n=d(t(e)))}n||(n=d(this.defaultTemplate),e.header?n.find(".um-modal-header").html(e.header):n.find(".um-modal-header").remove(),e.footer?n.find(".um-modal-footer").html(e.footer):n.find(".um-modal-footer").remove());let i=n.find(".um-modal-body");switch(typeof e.content){case"function":let o=e.content.apply(n,[t,e]);"object"==typeof o&&"number"==typeof o.readyState&&"function"==typeof o.done?(wp.hooks.doAction("um-modal-before-ajax",n,e,o),this.loading(!0,n),o.done(function(t){wp.hooks.doAction("um-modal-after-ajax",n,t,o),UM.modal.loading(!1,n)})):this.setContent(o,n);break;case"object":this.setContent(d(e.content).clone(),n);break;case"string":"loading"===e.content?this.loading(!0,n):/^https?:/.test(e.content)?(this.loading(!0,n),i.load(e.content.trim(),function(){this.loading(!1,n),UM.modal.responsive(n)})):/^(#|\.)/.test(e.content)&&d(e.content).length?this.setContent(d(e.content).clone().children(),n):this.setContent(e.content,n);break;default:this.setContent(e.content,n)}if("object"==typeof(n.get(0).umModalOptions=e).attributes)for(var o in e.attributes)n.attr(o,e.attributes[o]);return e.classes.length&&n.addClass(e.classes),e.size.length&&n.addClass(e.size),n.on("click",'a:not([href^="javascript"])',this.stopEvent),n.on("touchmove",this.stopEvent),i.find("img").on("load",function(){UM.modal.responsive(n)}),wp.hooks.doAction("um-modal-before-add",n,e),this.hide(),this.M.push(n),this.show(n),n},addOverlay:function(){return d("body > .um-modal-overlay").length<1&&d(document.body).addClass("um-overflow-hidden").append('<div class="um-modal-overlay"></div>').on("touchmove",this.stopEvent),d("body > .um-modal-overlay")},clear:function(){this.M=[],d(document.body).removeClass("um-overflow-hidden").off("touchmove").children(".um-modal-overlay, .um-modal").remove(),"hidden"===d(document.body).css("overflow-y")&&d(document.body).css("overflow-y","visible")},close:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),1<this.M.length?(this.M.pop().remove(),this.show()):this.clear(),this},closeAll:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),this.clear(),this},filterOptions:function(t){var o=wp.hooks.applyFilters("um-modal-def-options",this.defaultOptions);return d.extend({},o,t)},getModal:function(e){let n;return"object"==typeof e?n=d(e):"string"==typeof e&&1<=this.M.length?d.each(this.M,function(t,o){o.is(e)&&(n=o)}):n=1<=this.M.length?this.M[this.M.length-1]:d("div.um-modal:not(.um-modal-hidden)").filter(":visible"),n.length?n.last():null},hide:function(t){let o=this.getModal(t);return o&&(o.detach(),wp.hooks.doAction("um-modal-hidden",o)),o},loading:function(t,o){let e=this.getModal(o);return t?(e.addClass("loading"),e.on("click",this.stopEvent)):(e.removeClass("loading"),e.off("click")),this},responsive:function(n){let i=this.getModal(n);if(i){i.css({opacity:0});var d=+i.find(".um-modal-header").outerHeight(),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let t=i.find(".um-modal-body > img").filter(":visible"),o={},e={};t.length?(t.css({maxHeight:.8*n,maxWidth:.8*a}),o.bottom=(n-i.innerHeight())/2+"px",o.marginLeft="-"+t.width()/2+"px",o.width=t.width()):a<=340||a<=500?(o.bottom=0,o.height=n,o.width=a):(a<=800||a<=960||960<a)&&(o.bottom=(n-i.innerHeight())/2+"px",o.maxHeight=n-30,e.maxHeight=o.maxHeight-d),i.width()>a&&(o.width=.9*a,o.marginLeft="-"+o.width/2+"px"),o=wp.hooks.applyFilters("um-modal-responsive",o,i),i.css(o),i.css({opacity:1}),i.find(".um-modal-body").css(e)}return this},setContent:function(t,o){let e=this.getModal(o);return e&&(e.find(".um-modal-body").html(t),wp.hooks.doAction("um-modal-content-added",e)),this},show:function(t){let o=this.getModal(t);return o&&(t=o.get(0).umModalOptions,this.addOverlay().after(o),this.responsive(o),o.animate({opacity:1},t.duration),wp.hooks.doAction("um-modal-shown",o)),o},buttonClick:function(t){t.preventDefault(),wp.hooks.doAction("um-modal-button-clicked",t.data.settings,t),UM.modal.addModal(t.data.settings,t)},stopEvent:function(t){t.preventDefault(),t.stopPropagation()},destroy:function(t){let o=this.getModal(t);return o&&(wp.hooks.doAction("um-modal-before-destroy",o),o.each(function(t){let o=d(this)[0].umModalOptions.relatedButton;o.off("click",UM.modal.buttonClick),o.data("um-modal-ready",!1)}),this.clear()),o}},void 0===window.UM&&(window.UM={}),UM.modal=new t,d(document.body).on("click",".um-modal-overlay, .um-modal-close",function(t){t.preventDefault(),UM.modal.close()}),d(window).on("load",function(){UM.modal.responsive()}),d(window).on("resize",function(){UM.modal.responsive()}),d.fn.umModal=function(t){const e=d.extend({classes:"",duration:400,footer:"",header:"",size:"normal",content:""},t);return this.each(function(t){let o=d(this);o.data("um-modal-ready")||(e.relatedButton=o,o.on("click",{settings:e},UM.modal.buttonClick),o.data("um-modal-ready",!0))}),this}}(jQuery);